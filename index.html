<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222" media="(prefers-color-scheme: light)">
<meta name="theme-color" content="#222" media="(prefers-color-scheme: dark)"><meta name="generator" content="Hexo 6.3.0">

  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">

<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=PingFang+SC:300,300italic,400,400italic,700,700italic%7Cconsolas:300,300italic,400,400italic,700,700italic%7CKaiTi:300,300italic,400,400italic,700,700italic%7CSimSum:300,300italic,400,400italic,700,700italic&display=swap&subset=latin,latin-ext">

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.2.0/css/all.min.css" integrity="sha256-AbA177XfpSnFEvgpYu1jMygiLabzPCJCRIBtR5jGc0k=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.css" integrity="sha256-Vzbj7sDDS/woiFS3uNKo8eIuni59rjyNGtXfstRzStA=" crossorigin="anonymous">

<script class="next-config" data-name="main" type="application/json">{"hostname":"example.com","root":"/","images":"/images","scheme":"Gemini","darkmode":true,"version":"8.13.2","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12},"copycode":{"enable":false,"style":null},"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"搜索...","empty":"没有找到任何搜索结果：${query}","hits_time":"找到 ${hits} 个搜索结果（用时 ${time} 毫秒）","hits":"找到 ${hits} 个搜索结果"}}</script><script src="/js/config.js"></script>

    <meta name="description" content="学习交流">
<meta property="og:type" content="website">
<meta property="og:title" content="LJGUO">
<meta property="og:url" content="http://example.com/index.html">
<meta property="og:site_name" content="LJGUO">
<meta property="og:description" content="学习交流">
<meta property="og:locale" content="zh_CN">
<meta property="article:author" content="ljguo">
<meta property="article:tag" content="LaTeX, Java">
<meta name="twitter:card" content="summary">


<link rel="canonical" href="http://example.com/">



<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":true,"isPost":false,"lang":"zh-CN","comments":"","permalink":"","path":"index.html","title":""}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>LJGUO</title>
  






  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
</head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <h1 class="site-title">LJGUO</h1>
      <i class="logo-line"></i>
    </a>
      <p class="site-subtitle" itemprop="description">芒果不盲</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a></li><li class="menu-item menu-item-tags"><a href="/tags" rel="section"><i class="fa fa-tags fa-fw"></i>标签</a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类</a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a></li><li class="menu-item menu-item-随笔"><a href="/diary/" rel="section"><i class="fa fa-pen-nib fa-fw"></i>随笔</a></li><li class="menu-item menu-item-目标"><a href="/flag/" rel="section"><i class="fa fa-flag fa-fw"></i>目标</a></li><li class="menu-item menu-item-关于我"><a href="/about/" rel="section"><i class="fa fa-bolt fa-fw"></i>关于我</a></li>
  </ul>
</nav>




</div>
        
  
  <div class="toggle sidebar-toggle" role="button">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>

  <aside class="sidebar">

    <div class="sidebar-inner sidebar-overview-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author site-overview-item animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">ljguo</p>
  <div class="site-description" itemprop="description">学习交流</div>
</div>
<div class="site-state-wrap site-overview-item animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/archives/">
          <span class="site-state-item-count">21</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
          <a href="/categories/">
        <span class="site-state-item-count">2</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
          <a href="/tags">
        <span class="site-state-item-count">7</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author site-overview-item animated">
      <span class="links-of-author-item">
        <a href="https://github.com/ljguo1020" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;ljguo1020" rel="noopener" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="mailto:ljguo1020@gmail.com" title="E-Mail → mailto:ljguo1020@gmail.com" rel="noopener" target="_blank"><i class="fa fa-envelope fa-fw"></i>E-Mail</a>
      </span>
  </div>



        </div>
      </div>
    </div>
  </aside>
  <div class="sidebar-dimmer"></div>


    </header>

    
  <div class="back-to-top" role="button" aria-label="返回顶部">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


    <div class="main-inner index posts-expand">

    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://example.com/1970/01/01/LaTeX-answer-show-after/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="ljguo">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="LJGUO">
      <meta itemprop="description" content="学习交流">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | LJGUO">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/1970/01/01/LaTeX-answer-show-after/" class="post-title-link" itemprop="url">LaTeX 中暂存答案</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：1970-01-01 08:00:00" itemprop="dateCreated datePublished" datetime="1970-01-01T08:00:00+08:00">1970-01-01</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2022-11-11 22:37:53" itemprop="dateModified" datetime="2022-11-11T22:37:53+08:00">2022-11-11</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/LaTeX/" itemprop="url" rel="index"><span itemprop="name">LaTeX</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <blockquote>
<p>本文介绍如何在 LaTeX2e 中实现答案控制的效果，也即是答案统一在后面显示，考虑到有些朋友没有学习 LaTeX3，所以本文尽量用 LaTeX2e &amp; TeX 来实现，如果对 LaTeX3 感兴趣，可以参考下面的文章</p>
</blockquote>
<p><a target="_blank" rel="noopener" href="https://ljguo1020.github.io/2022/02/17/LaTeX-answer/">使用 LaTeX3 在试卷中做一个答案统计</a></p>
<p><a target="_blank" rel="noopener" href="https://www.latexstudio.net/index/details/index/mid/2468">用l3的seq实现习题答案统一输出</a></p>
<h2 id="实现原理"><a href="#实现原理" class="headerlink" title="实现原理"></a>实现原理</h2><p>我们的想法其实就是要在前面输入答案，但是不做输出，而是存起来，然后放到指定位置输出，例如</p>
<figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">1.这是题目这是题目...</span><br><span class="line"><span class="keyword">\answer</span>&#123;C&#125;</span><br><span class="line">2.这是题目这是题目...</span><br><span class="line"><span class="keyword">\answer</span>&#123;B&#125;</span><br><span class="line">...</span><br><span class="line"><span class="keyword">\showanswer</span></span><br></pre></td></tr></table></figure>

<p>大概就是这样，使用 <code>\showanswer</code> 命令来显示答案</p>
<h2 id="讨论"><a href="#讨论" class="headerlink" title="讨论"></a>讨论</h2><p>不知道大家有没有注意过一个问题，在标准文档类中的 <code>\author</code>,<code>\title</code>,<code>\date</code> , 这些命令使用后并不会立即输出，而是等到 <code>\maketitle</code> 命令的到来才会输出，其实它就在做这样一个事情</p>
<p>为了更加清楚，我们来看看其源码，在命令行使用 <code>latexdef -s \author</code> 即可查看其定义</p>
<p><img src="https://ljguo-1308058910.cos.ap-nanjing.myqcloud.com//img/answer-show-after1.png" alt="\author"></p>
<p>哎，简化一下吧，大概类似于</p>
<figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">\newcommand</span>*&#123;<span class="keyword">\author</span>&#125;[1]&#123;<span class="keyword">\newcommand</span>&#123;<span class="keyword">\@author</span>&#125;&#123;<span class="params">#1</span>&#125;&#125;</span><br></pre></td></tr></table></figure>

<p>嘿，我们再来看看 <code>\maketitle</code> 命令呢，同样使用 <code>latexdef -c article \maketitle</code> </p>
<p><img src="https://ljguo-1308058910.cos.ap-nanjing.myqcloud.com//img/answer-show-after2.png" alt="\maketitle"></p>
<p>好吧，有点乱，我也没读懂，我猜测应该是设置了一些格式，然后将前面定义的所有与封面相关的元素全部删除了，好像没有多少对我们有用的信息呢.  咿<del>，我发现有个 <code>\@maketitle</code> ,这小家伙藏得还挺深，还是被我揪出来了</del>，<code>latexdef -c article \@maketitle</code> </p>
<p><img src="https://ljguo-1308058910.cos.ap-nanjing.myqcloud.com//img/answer-show-after3.png" alt="\@maketitle"></p>
<p>原来都藏在这儿呢，在封面使用前面定义的 <code>\@author</code> <code>\@title</code> 等，注意了，不是 <code>\author</code> <code>\title</code> 哦.</p>
<p> (做封面的朋友该有想法了)</p>
<p>回来吧，现在我们应该清楚了，<code>\author</code> 命令的作用只是在间接定义 <code>\@author</code> ，实际并不做输出</p>
<h2 id="开始动手"><a href="#开始动手" class="headerlink" title="开始动手"></a>开始动手</h2><h3 id="设计输入"><a href="#设计输入" class="headerlink" title="设计输入"></a>设计输入</h3><p>我们也可以仿照它的做法，来实现我们的效果，使用如下代码</p>
<figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">\newcommand</span>&#123;<span class="keyword">\answer</span>&#125;[1]&#123;<span class="keyword">\def</span><span class="keyword">\@answer</span>&#123;<span class="params">#1</span>&#125;&#125;</span><br></pre></td></tr></table></figure>

<p>这里使用 <code>\def</code> 是为了避免 <code> Command \@answer already defined.</code> 的问题</p>
<p>但是这样有一个问题，当我们使用</p>
<figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">\answer</span>&#123;A&#125;</span><br><span class="line"><span class="keyword">\answer</span>&#123;B&#125;</span><br><span class="line"><span class="keyword">\answer</span>&#123;C&#125;</span><br></pre></td></tr></table></figure>

<p>后，实际保存在 <code>\@answer</code> 里面的值是 C，所以我们只用一个宏来保存答案似乎不太好办（LaTeX3 里面倒是很简单），最好是为每一个题目都分配一个宏来保存答案，考虑如下</p>
<figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">\newcommand</span>&#123;<span class="keyword">\answerI</span>&#125;[1]&#123;<span class="keyword">\def</span><span class="keyword">\@answerI</span>&#123;<span class="params">#1</span>&#125;&#125;</span><br><span class="line"><span class="keyword">\newcommand</span>&#123;<span class="keyword">\answerII</span>&#125;[1]&#123;<span class="keyword">\def</span><span class="keyword">\@answerII</span>&#123;<span class="params">#1</span>&#125;&#125;</span><br><span class="line"><span class="keyword">\newcommand</span>&#123;<span class="keyword">\answerIII</span>&#125;[1]&#123;<span class="keyword">\def</span><span class="keyword">\@answerIII</span>&#123;<span class="params">#1</span>&#125;&#125;</span><br><span class="line">...</span><br></pre></td></tr></table></figure>

<p>一张试卷 20 多个题目，难道我们要定义 20 多个命令？太麻烦了！如果能自动根据题号来定义命令就好了</p>
<p>唉，我想到了计数器，为其分配一个计数器 <code>answer</code>，尝试如下代码</p>
<figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">\newcommand</span>&#123;<span class="keyword">\answer</span>&#125;[1]&#123;<span class="keyword">\def</span><span class="keyword">\answer</span><span class="keyword">\theanswer</span>&#123;<span class="params">#1</span>&#125;&#125;</span><br></pre></td></tr></table></figure>

<p>这样，使用第一次 <code>\answer</code> 就定义了 <code>\answer1</code> , 第二次就定义了 <code>\answer2</code> ,但是这样定义有两个问题</p>
<ol>
<li><code>\def\answer\theanswer</code> 本身是有问题的</li>
<li><code>\answer1</code> 这样的命令命名是有问题的，数字正常情况下不能作为命令名</li>
</ol>
<p>但是，不要气馁，我们正在慢慢接近答案</p>
<p>解决第一个问题就涉及到 TeX 中 <strong>迷人的宏展开</strong> 了，当然这里只涉及到很简单的</p>
<p>介绍两个命令 <code>\csname</code> 和 <code>\endcsname</code> , 我们使用如下命令</p>
<figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">\csname</span> textbf <span class="keyword">\endcsname</span>&#123;abc&#125; <span class="comment">% ---&gt; \textbf&#123;abc&#125;</span></span><br><span class="line"><span class="keyword">\def</span><span class="keyword">\aa</span>&#123;textbf&#125;</span><br><span class="line"><span class="keyword">\csname</span> <span class="keyword">\aa</span> <span class="keyword">\endcsname</span>&#123;abc&#125; <span class="comment">% ---&gt; \textbf&#123;abc&#125;</span></span><br></pre></td></tr></table></figure>

<p>也就是说，夹在 <code>\csname</code> 和 <code>\endcsname</code> 之间的部分会先被完全展开至不可展开为止，然后再为其加上 <code>\</code> 使其成为一个控制序列（命令）</p>
<p>解决第二个问题也很简单，我们只需将数字转化为罗马数字即可，这里是计数器，我们直接使用现成的<code>\roman&#123;answer&#125;</code> 即可</p>
<p>我们考虑如下定义</p>
<figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">\def</span><span class="keyword">\answer</span><span class="params">#1</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">\expandafter</span><span class="keyword">\gdef</span><span class="keyword">\csname</span> answer<span class="keyword">\roman</span>&#123;answer&#125;<span class="keyword">\endcsname</span>&#123;<span class="params">#1</span>&#125;</span><br><span class="line">  <span class="keyword">\stepcounter</span>&#123;answer&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>这里使用了 <code>\expandafter</code> ,是为了跳过 \def 先展开 <code>\csname</code> 和 <code>\endcsname</code> 之间的内容，然后再 <code>\def</code> </p>
<h3 id="设计输出"><a href="#设计输出" class="headerlink" title="设计输出"></a>设计输出</h3><p>输出的话我们可以</p>
<figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">\answeri</span></span><br><span class="line"><span class="keyword">\answerii</span></span><br><span class="line"><span class="keyword">\answeriii</span></span><br><span class="line">...</span><br></pre></td></tr></table></figure>

<p>但更好的是使用循环来做这件事情，这里使用 <code>pgffor</code> 宏包提供的 <code>\foreach</code> 命令</p>
<figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">\foreach</span>[parse] <span class="keyword">\x</span> in&#123;1,2,...,<span class="keyword">\theanswer</span>&#125;</span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">\csname</span> answer<span class="keyword">\romannumeral</span><span class="keyword">\x</span> <span class="keyword">\endcsname</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>注意这里的 <code>\romannumeral</code> 接受一个数字， 并将其转化为小写罗马数字，区别于刚刚的 <code>\roman</code> , 它是接受一个计数器，而不是接受数字</p>
<h2 id="实现源码"><a href="#实现源码" class="headerlink" title="实现源码"></a>实现源码</h2><p>现在我们将代码整合一下</p>
<figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">\documentclass</span>&#123;ctexart&#125;</span><br><span class="line"><span class="keyword">\usepackage</span>&#123;pgffor&#125;</span><br><span class="line"><span class="keyword">\newcounter</span>&#123;answer&#125;</span><br><span class="line"><span class="keyword">\setcounter</span>&#123;answer&#125;&#123;1&#125;</span><br><span class="line"><span class="keyword">\def</span><span class="keyword">\answer</span><span class="params">#1</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">\expandafter</span><span class="keyword">\gdef</span><span class="keyword">\csname</span> answer<span class="keyword">\roman</span>&#123;answer&#125;<span class="keyword">\endcsname</span>&#123;<span class="params">#1</span>&#125;</span><br><span class="line">  <span class="keyword">\stepcounter</span>&#123;answer&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">\def</span><span class="keyword">\showanswer</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">\foreach</span>[parse] <span class="keyword">\x</span> in&#123;1,2,...,<span class="keyword">\theanswer</span>&#125;</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">\csname</span> answer<span class="keyword">\romannumeral</span><span class="keyword">\x</span> <span class="keyword">\endcsname</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">\begin</span>&#123;document&#125;</span><br><span class="line"><span class="keyword">\begin</span>&#123;enumerate&#125;</span><br><span class="line">  <span class="keyword">\item</span> 这是题目这是题目 <span class="keyword">\answer</span>&#123;A&#125;</span><br><span class="line">  <span class="keyword">\item</span> 这是题目这是题目 <span class="keyword">\answer</span>&#123;D&#125;</span><br><span class="line">  <span class="keyword">\item</span> 这是题目这是题目 <span class="keyword">\answer</span>&#123;B&#125;</span><br><span class="line">  <span class="keyword">\item</span> 这是题目这是题目 <span class="keyword">\answer</span>&#123;C&#125;</span><br><span class="line">  <span class="keyword">\item</span> 这是题目这是题目 <span class="keyword">\answer</span>&#123;B&#125;</span><br><span class="line"><span class="keyword">\end</span>&#123;enumerate&#125;</span><br><span class="line">答案分别是：<span class="keyword">\showanswer</span></span><br><span class="line"><span class="keyword">\end</span>&#123;document&#125;</span><br></pre></td></tr></table></figure>

<p>输出</p>
<p><img src="https://ljguo-1308058910.cos.ap-nanjing.myqcloud.com//img/answer-show-after4.png" alt="输出"></p>
<p>好了，至此本文结束，下期再见吧 ~</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://example.com/1970/01/01/LaTeX-answer/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="ljguo">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="LJGUO">
      <meta itemprop="description" content="学习交流">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | LJGUO">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/1970/01/01/LaTeX-answer/" class="post-title-link" itemprop="url">使用 LaTeX3 在试卷中做一个答案统计</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：1970-01-01 08:00:00" itemprop="dateCreated datePublished" datetime="1970-01-01T08:00:00+08:00">1970-01-01</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2022-11-11 22:40:10" itemprop="dateModified" datetime="2022-11-11T22:40:10+08:00">2022-11-11</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/LaTeX/" itemprop="url" rel="index"><span itemprop="name">LaTeX</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h2 id="问题的提出"><a href="#问题的提出" class="headerlink" title="问题的提出"></a>问题的提出</h2><p>在群里有老师想要实现如下的一个答案统计效果</p>
<p><img src="https://ljguo-1308058910.cos.ap-nanjing.myqcloud.com//img/QQ%E6%88%AA%E5%9B%BE20220217123653.png"></p>
<p>这本来是 <code>exam</code> 文档类提供的一个功能，奈何有些老师不想使用这个文类，我们只好造一个轮子</p>
<h2 id="分析问题"><a href="#分析问题" class="headerlink" title="分析问题"></a>分析问题</h2><p>我们需要注意到：</p>
<ul>
<li>这个<strong>答案列表</strong>应该是在排版选择题的时候就输入，而不是最后来输入</li>
<li>也就是我们需要先将前面的答案暂存起来，最后再来排版出来</li>
<li><strong>计数</strong>功能，我们还需要去检测答案列表中各个选项的数量</li>
</ul>
<h2 id="解决问题"><a href="#解决问题" class="headerlink" title="解决问题"></a>解决问题</h2><p>首先我们需要一个排版选择题答案的命令</p>
<p>有不少老师在使用 <code>\xx&#123;&#125;&#123;&#125;&#123;&#125;&#123;&#125;</code>这个命令，如果你没有类似的命令，我仿造他们的思路造了一个这样的命令<code>\choices&#123;&#125;&#123;&#125;&#123;&#125;&#123;&#125;</code>，源码如下，这里参考了公众号<a target="_blank" rel="noopener" href="https://mp.weixin.qq.com/s/nq6Qx_yCX5Vt4Acl--RX6w"><strong>不会功夫的熊猫</strong></a>的方法</p>
<blockquote>
<p>这里排版选择题我特别推荐<a target="_blank" rel="noopener" href="https://github.com/xkwxdyy">xkwxdyy</a>的 <code>xchoices</code> 宏包，这个宏包功能十分强大，对选择题可以很灵活的排版，项目地址 <a target="_blank" rel="noopener" href="https://github.com/xkwxdyy/xchoices">https://github.com/xkwxdyy/xchoices</a></p>
</blockquote>
<figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">\ExplSyntaxOn</span></span><br><span class="line"><span class="keyword">\cs_new_protected:Npn</span> <span class="keyword">\g</span><span class="built_in">_</span>choices: <span class="params">#1</span><span class="params">#2</span><span class="params">#3</span><span class="params">#4</span> &#123;</span><br><span class="line">  <span class="keyword">\par</span><span class="keyword">\noindent</span></span><br><span class="line"><span class="keyword">\box_clear_new:N</span> <span class="keyword">\l_choiceA_box</span></span><br><span class="line"><span class="keyword">\box_clear_new:N</span> <span class="keyword">\l_choiceB_box</span></span><br><span class="line"><span class="keyword">\box_clear_new:N</span> <span class="keyword">\l_choiceC_box</span></span><br><span class="line"><span class="keyword">\box_clear_new:N</span> <span class="keyword">\l_choiceD_box</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">\hbox_set:Nn</span> <span class="keyword">\l_choiceA_box</span>&#123;A.<span class="params">#1</span>~~&#125;</span><br><span class="line"><span class="keyword">\hbox_set:Nn</span> <span class="keyword">\l_choiceB_box</span>&#123;B.<span class="params">#2</span>~~&#125;</span><br><span class="line"><span class="keyword">\hbox_set:Nn</span> <span class="keyword">\l_choiceC_box</span>&#123;C.<span class="params">#3</span>~~&#125;</span><br><span class="line"><span class="keyword">\hbox_set:Nn</span> <span class="keyword">\l_choiceD_box</span>&#123;D.<span class="params">#4</span>~~&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">\dim_zero_new:N</span> <span class="keyword">\l_choice_wd_max_AB</span></span><br><span class="line"><span class="keyword">\dim_zero_new:N</span> <span class="keyword">\l_choice_wd_max_CD</span> </span><br><span class="line"><span class="keyword">\dim_zero_new:N</span> <span class="keyword">\l_choice_wd_max</span></span><br><span class="line"> <span class="keyword">\dim_set:Nn</span> <span class="keyword">\l_choice_wd_max_AB</span> &#123;<span class="keyword">\dim_max:nn</span>&#123;<span class="keyword">\box_wd:N</span> <span class="keyword">\l_choiceA_box</span>&#125;&#123;<span class="keyword">\box_wd:N</span> <span class="keyword">\l_choiceB_box</span>&#125;&#125;</span><br><span class="line"> <span class="keyword">\dim_set:Nn</span> <span class="keyword">\l_choice_wd_max_CD</span> &#123;<span class="keyword">\dim_max:nn</span>&#123;<span class="keyword">\box_wd:N</span> <span class="keyword">\l_choiceC_box</span>&#125;&#123;<span class="keyword">\box_wd:N</span> <span class="keyword">\l_choiceD_box</span>&#125;&#125;</span><br><span class="line"> <span class="keyword">\dim_set:Nn</span> <span class="keyword">\l_choice_wd_max</span> &#123;<span class="keyword">\dim_max:nn</span>&#123;<span class="keyword">\dim_use:N</span> <span class="keyword">\l_choice_wd_max_AB</span>&#125;&#123;<span class="keyword">\dim_use:N</span> <span class="keyword">\l_choice_wd_max_CD</span>&#125;&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">\dim_compare:nNnTF</span>&#123;<span class="keyword">\dim_use:N</span> <span class="keyword">\l_choice_wd_max</span>&#125; &lt; &#123;0.25<span class="keyword">\linewidth</span>&#125;</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">\box_set_wd:Nn</span> <span class="keyword">\l_choiceA_box</span> &#123;0.25<span class="keyword">\linewidth</span>&#125;</span><br><span class="line"><span class="keyword">\box_set_wd:Nn</span> <span class="keyword">\l_choiceB_box</span> &#123;0.25<span class="keyword">\linewidth</span>&#125;</span><br><span class="line"><span class="keyword">\box_set_wd:Nn</span> <span class="keyword">\l_choiceC_box</span> &#123;0.25<span class="keyword">\linewidth</span>&#125;</span><br><span class="line"><span class="keyword">\box_set_wd:Nn</span> <span class="keyword">\l_choiceD_box</span> &#123;0.25<span class="keyword">\linewidth</span>&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">\box_use:N</span> <span class="keyword">\l_choiceA_box</span></span><br><span class="line"><span class="keyword">\box_use:N</span> <span class="keyword">\l_choiceB_box</span></span><br><span class="line"><span class="keyword">\box_use:N</span> <span class="keyword">\l_choiceC_box</span></span><br><span class="line"><span class="keyword">\box_use:N</span> <span class="keyword">\l_choiceD_box</span></span><br><span class="line">&#125;</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">\dim_compare:nNnTF</span>&#123;<span class="keyword">\dim_use:N</span> <span class="keyword">\l_choice_wd_max</span>&#125; &lt; &#123;0.5<span class="keyword">\linewidth</span>&#125;</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">\box_set_wd:Nn</span> <span class="keyword">\l_choiceA_box</span> &#123;0.45<span class="keyword">\linewidth</span>&#125;</span><br><span class="line"><span class="keyword">\box_set_wd:Nn</span> <span class="keyword">\l_choiceB_box</span> &#123;0.45<span class="keyword">\linewidth</span>&#125;</span><br><span class="line"><span class="keyword">\box_set_wd:Nn</span> <span class="keyword">\l_choiceC_box</span> &#123;0.45<span class="keyword">\linewidth</span>&#125;</span><br><span class="line"><span class="keyword">\box_set_wd:Nn</span> <span class="keyword">\l_choiceD_box</span> &#123;0.45<span class="keyword">\linewidth</span>&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">\box_use:N</span> <span class="keyword">\l_choiceA_box</span></span><br><span class="line"><span class="keyword">\box_use:N</span> <span class="keyword">\l_choiceB_box</span></span><br><span class="line"><span class="keyword">\par</span><span class="keyword">\vspace</span>*&#123;0.5em&#125;<span class="keyword">\hspace</span>&#123;2em&#125;</span><br><span class="line"><span class="keyword">\box_use:N</span> <span class="keyword">\l_choiceC_box</span></span><br><span class="line"><span class="keyword">\box_use:N</span> <span class="keyword">\l_choiceD_box</span></span><br><span class="line">&#125;</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">\box_use:N</span> <span class="keyword">\l_choiceA_box</span></span><br><span class="line"><span class="keyword">\par</span><span class="keyword">\vspace</span>*&#123;0.5em&#125;<span class="keyword">\hspace</span>&#123;2em&#125;</span><br><span class="line"><span class="keyword">\box_use:N</span> <span class="keyword">\l_choiceB_box</span></span><br><span class="line"><span class="keyword">\par</span><span class="keyword">\vspace</span>*&#123;0.5em&#125;<span class="keyword">\hspace</span>&#123;2em&#125;</span><br><span class="line"><span class="keyword">\box_use:N</span> <span class="keyword">\l_choiceC_box</span></span><br><span class="line"><span class="keyword">\par</span><span class="keyword">\vspace</span>*&#123;0.5em&#125;<span class="keyword">\hspace</span>&#123;2em&#125;</span><br><span class="line"><span class="keyword">\box_use:N</span> <span class="keyword">\l_choiceD_box</span>   </span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">\cs_set_eq:NN</span> <span class="keyword">\choices</span> <span class="keyword">\g</span><span class="built_in">_</span>choices:</span><br><span class="line"><span class="keyword">\ExplSyntaxOff</span></span><br></pre></td></tr></table></figure>

<p>有了个命令，就比较方便了，我们只需要在原有的命令上面加上一个参数来接受正确答案的选项就好了</p>
<figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">\NewDocumentCommand</span>&#123;<span class="keyword">\choices</span>&#125;&#123;ommmm&#125;</span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">\IfNoValueTF</span>&#123;<span class="params">#1</span>&#125;</span><br><span class="line">    &#123;<span class="keyword">\seq_put_right:Nn</span><span class="keyword">\_</span><span class="built_in">_</span>answer<span class="built_in">_</span>list<span class="built_in">_</span>seq&#123;<span class="keyword">\space</span>&#125;&#125;</span><br><span class="line">    &#123;<span class="keyword">\seq_put_right:Nn</span><span class="keyword">\_</span><span class="built_in">_</span>answer<span class="built_in">_</span>list<span class="built_in">_</span>seq&#123;<span class="params">#1</span>&#125;&#125;</span><br><span class="line">  <span class="keyword">\choice</span>&#123;<span class="params">#2</span>&#125;&#123;<span class="params">#3</span>&#125;&#123;<span class="params">#4</span>&#125;&#123;<span class="params">#5</span>&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>这里重新定义了一个<code>\choices[]&#123;&#125;&#123;&#125;&#123;&#125;&#123;&#125;</code> 命令，第一个可选参数接受正确答案</p>
<p>观察到上面有三行代码</p>
<figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">\IfNoValueTF</span>&#123;<span class="params">#1</span>&#125;</span><br><span class="line">    &#123;<span class="keyword">\seq_put_right:Nn</span><span class="keyword">\_</span><span class="built_in">_</span>answer<span class="built_in">_</span>list<span class="built_in">_</span>seq&#123;<span class="keyword">\space</span>&#125;&#125;</span><br><span class="line">    &#123;<span class="keyword">\seq_put_right:Nn</span><span class="keyword">\_</span><span class="built_in">_</span>answer<span class="built_in">_</span>list<span class="built_in">_</span>seq&#123;<span class="params">#1</span>&#125;&#125;</span><br></pre></td></tr></table></figure>

<p>这行代码是用于检测第一个可选参数，如果有可选参数，则将接受到的参数向右追加到 <code>\__answer_list_seq</code> 这个序列里面，如果没有可选参数，追加一个 <code>\space</code> 标记</p>
<p>下面我们需要定义和初始化一些变量</p>
<figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">\seq_clear_new:N</span> <span class="keyword">\_</span><span class="built_in">_</span>answer<span class="built_in">_</span>list<span class="built_in">_</span>seq <span class="comment">% 用于保存答案列表</span></span><br><span class="line"><span class="keyword">\int_zero_new:N</span> <span class="keyword">\_</span><span class="built_in">_</span>choice<span class="built_in">_</span>amount<span class="built_in">_</span>int <span class="comment">% 用于获取各个选项数量</span></span><br></pre></td></tr></table></figure>

<p>我们来解释一些上面的 <code>\seq_put_right:Nn</code> 函数，例如现在我们有一个空序列变量 <code>\__answer_list_seq</code> 我们使用如下命令后</p>
<figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">\choices</span>[A]&#123;A&#125;&#123;B&#125;&#123;C&#125;&#123;D&#125;</span><br><span class="line"><span class="keyword">\choices</span>[B]&#123;A&#125;&#123;B&#125;&#123;C&#125;&#123;D&#125;</span><br><span class="line"><span class="keyword">\choices</span>[C]&#123;A&#125;&#123;B&#125;&#123;C&#125;&#123;D&#125;</span><br><span class="line"><span class="keyword">\choices</span>[A]&#123;A&#125;&#123;B&#125;&#123;C&#125;&#123;D&#125;</span><br><span class="line"><span class="keyword">\choices</span>[C]&#123;A&#125;&#123;B&#125;&#123;C&#125;&#123;D&#125;</span><br></pre></td></tr></table></figure>

<p>此时这个<code>\__answer_list_seq</code> 的值就是 <code>ABCAC</code> 了</p>
<p>使用如下命令可以获取到 <code>\__answer_list_seq</code>  这个序列某项的值</p>
<figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">\seq_item:Nn</span><span class="keyword">\_</span><span class="built_in">_</span>answer<span class="built_in">_</span>list<span class="built_in">_</span>seq&#123;2&#125; <span class="comment">% ---&gt; B</span></span><br></pre></td></tr></table></figure>

<p>那么我们来定义一个命令来显示答案列表，<code>\seq_count:N</code> 命令用于获取序列的长度，<code>\int_step_inline:nnn</code> 用于创建一个整数循环</p>
<figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">\NewDocumentCommand</span>&#123;<span class="keyword">\answerlists</span>&#125;&#123;&#125;</span><br><span class="line">&#123;</span><br><span class="line">答案列表:~<span class="keyword">\int_step_inline:nnn</span>&#123;1&#125;&#123;<span class="keyword">\seq_count:N</span> <span class="keyword">\_</span><span class="built_in">_</span>answer<span class="built_in">_</span>list<span class="built_in">_</span>seq&#125;</span><br><span class="line">&#123;<span class="params">##1</span>.<span class="keyword">\seq_item:Nn</span><span class="keyword">\_</span><span class="built_in">_</span>answer<span class="built_in">_</span>list<span class="built_in">_</span>seq&#123;<span class="params">##1</span>&#125;~&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>此时再使用 <code>\answerlists</code> 命令就可以得到</p>
<blockquote>
<p>答案列表: 1.A 2.B 3.C 4.A 5.C</p>
</blockquote>
<p>下面的问题就是来解决这个选项计数的功能</p>
<p>例如现在我们的 <code>\__answer_list_seq</code> 中保存的值为 <code>ABCAC</code> ，我们如何去获取各个选项的值呢？</p>
<p>当然这里有一个思路，可以用 <code>\seq_map_inline:Nn </code> ，然后使用一个加法计数器来得到各选项的值，但是感觉比较麻烦，所以这里我将使用正则表达式来获取匹配到的数量</p>
<figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">\regex_count:nnN</span>&#123;A&#125;&#123;ABCDAA&#125;<span class="keyword">\l_tmpa_int</span> <span class="comment">% ---&gt; \l_tmpa_int = 3</span></span><br></pre></td></tr></table></figure>

<p>这个 <code>\regex_count:nnN</code> 函数接受三个参数，第一个接受一个正则表达式，第二个接受待匹配内容，第三个接受一个整数变量，用于保存匹配到的次数的整数值</p>
<p>我们尝试 </p>
<figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">regex<span class="built_in">_</span>count:nnN&#123;A&#125;&#123;<span class="keyword">\_</span><span class="built_in">_</span>answer<span class="built_in">_</span>list<span class="built_in">_</span>seq&#125;<span class="keyword">\_</span><span class="built_in">_</span>choice<span class="built_in">_</span>amount<span class="built_in">_</span>int</span><br></pre></td></tr></table></figure>

<p>这样是不行的，因为第二个参数的 <code>n</code> 变体，无法为我们展开 <code>\__answer_list_seq</code> ，我们需要定义一个 <code>V</code> 变体</p>
<figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">\cs_generate_variant:Nn</span><span class="keyword">\regex_count:nnN</span>&#123;nVN&#125;</span><br></pre></td></tr></table></figure>

<p>这样我们就可以使用</p>
<figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">regex<span class="built_in">_</span>count:nVN&#123;A&#125; <span class="keyword">\_</span><span class="built_in">_</span>answer<span class="built_in">_</span>list<span class="built_in">_</span>seq <span class="keyword">\_</span><span class="built_in">_</span>choice<span class="built_in">_</span>amount<span class="built_in">_</span>int</span><br></pre></td></tr></table></figure>

<p>来得到选项 <code>A</code> 的数量了</p>
<p>现在来定义一个选项计数的命令</p>
<figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">\NewDocumentCommand</span>&#123;<span class="keyword">\choicescount</span>&#125;&#123;&#125;</span><br><span class="line">&#123;</span><br><span class="line">  选项计数: ~A:<span class="keyword">\regex_count:nVN</span>&#123;A&#125;<span class="keyword">\_</span><span class="built_in">_</span>answer<span class="built_in">_</span>list<span class="built_in">_</span>seq<span class="keyword">\_</span><span class="built_in">_</span>choice<span class="built_in">_</span>amount<span class="built_in">_</span>int</span><br><span class="line">  <span class="keyword">\int_use:N</span> <span class="keyword">\_</span><span class="built_in">_</span>choice<span class="built_in">_</span>amount<span class="built_in">_</span>int </span><br><span class="line">      <span class="keyword">\quad</span> B:<span class="keyword">\regex_count:nVN</span>&#123;B&#125;<span class="keyword">\_</span><span class="built_in">_</span>answer<span class="built_in">_</span>list<span class="built_in">_</span>seq<span class="keyword">\_</span><span class="built_in">_</span>choice<span class="built_in">_</span>amount<span class="built_in">_</span>int</span><br><span class="line">  <span class="keyword">\int_use:N</span> <span class="keyword">\_</span><span class="built_in">_</span>choice<span class="built_in">_</span>amount<span class="built_in">_</span>int </span><br><span class="line">      <span class="keyword">\quad</span> C:<span class="keyword">\regex_count:nVN</span>&#123;C&#125;<span class="keyword">\_</span><span class="built_in">_</span>answer<span class="built_in">_</span>list<span class="built_in">_</span>seq<span class="keyword">\_</span><span class="built_in">_</span>choice<span class="built_in">_</span>amount<span class="built_in">_</span>int</span><br><span class="line">  <span class="keyword">\int_use:N</span> <span class="keyword">\_</span><span class="built_in">_</span>choice<span class="built_in">_</span>amount<span class="built_in">_</span>int </span><br><span class="line">      <span class="keyword">\quad</span> D:<span class="keyword">\regex_count:nVN</span>&#123;D&#125;<span class="keyword">\_</span><span class="built_in">_</span>answer<span class="built_in">_</span>list<span class="built_in">_</span>seq<span class="keyword">\_</span><span class="built_in">_</span>choice<span class="built_in">_</span>amount<span class="built_in">_</span>int</span><br><span class="line">  <span class="keyword">\int_use:N</span> <span class="keyword">\_</span><span class="built_in">_</span>choice<span class="built_in">_</span>amount<span class="built_in">_</span>int</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>至此，这个问题已经被解决了</p>
<h2 id="完整源码"><a href="#完整源码" class="headerlink" title="完整源码"></a>完整源码</h2><figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">\documentclass</span>&#123;ctexart&#125;</span><br><span class="line"><span class="keyword">\usepackage</span>&#123;geometry&#125;</span><br><span class="line"><span class="keyword">\geometry</span>&#123;margin=2cm&#125;</span><br><span class="line"><span class="keyword">\begin</span>&#123;document&#125;</span><br><span class="line"><span class="comment">%%%%%%%%%%%%%%%%%% 定义\choice&#123;&#125;&#123;&#125;&#123;&#125;&#123;&#125;命令，如果你有，可以注释它 %%%%%%%%%%%%%%%%%%%%%</span></span><br><span class="line"><span class="keyword">\input</span>&#123;choice.tex&#125; <span class="comment">%% 这部分代码在上文中</span></span><br><span class="line"><span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span></span><br><span class="line"><span class="keyword">\ExplSyntaxOn</span></span><br><span class="line"><span class="keyword">\seq_clear_new:N</span> <span class="keyword">\_</span><span class="built_in">_</span>answer<span class="built_in">_</span>list<span class="built_in">_</span>seq</span><br><span class="line"><span class="keyword">\int_zero_new:N</span> <span class="keyword">\_</span><span class="built_in">_</span>choice<span class="built_in">_</span>amount<span class="built_in">_</span>int</span><br><span class="line"><span class="keyword">\cs_generate_variant:Nn</span><span class="keyword">\regex_count:nnN</span>&#123;nVN&#125;</span><br><span class="line"><span class="keyword">\NewDocumentCommand</span>&#123;<span class="keyword">\choice</span>&#125;&#123;ommmm&#125;</span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">\IfNoValueTF</span>&#123;<span class="params">#1</span>&#125;</span><br><span class="line">    &#123;<span class="keyword">\seq_put_right:Nn</span><span class="keyword">\_</span><span class="built_in">_</span>answer<span class="built_in">_</span>list<span class="built_in">_</span>seq&#123;<span class="keyword">\space</span></span><br><span class="line">    &#123;<span class="keyword">\seq_put_right:Nn</span><span class="keyword">\_</span><span class="built_in">_</span>answer<span class="built_in">_</span>list<span class="built_in">_</span>seq&#123;<span class="params">#1</span>&#125;&#125;</span><br><span class="line">  <span class="keyword">\choice</span>&#123;<span class="params">#2</span>&#125;&#123;<span class="params">#3</span>&#125;&#123;<span class="params">#4</span>&#125;&#123;<span class="params">#5</span>&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">\NewDocumentCommand</span>&#123;<span class="keyword">\answerlists</span>&#125;&#123;&#125;</span><br><span class="line">&#123;</span><br><span class="line">  答案列表:~<span class="keyword">\int_step_inline:nnn</span>&#123;1&#125;&#123;<span class="keyword">\seq_count:N</span> <span class="keyword">\_</span><span class="built_in">_</span>answer<span class="built_in">_</span>list<span class="built_in">_</span>seq&#125;</span><br><span class="line">         &#123;<span class="params">##1</span>.<span class="keyword">\seq_item:Nn</span><span class="keyword">\_</span><span class="built_in">_</span>answer<span class="built_in">_</span>list<span class="built_in">_</span>seq&#123;<span class="params">##1</span>&#125;~&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">\NewDocumentCommand</span>&#123;<span class="keyword">\choicescount</span>&#125;&#123;&#125;</span><br><span class="line">&#123;</span><br><span class="line">  选项计数: ~A:<span class="keyword">\regex_count:nVN</span>&#123;A&#125;<span class="keyword">\_</span><span class="built_in">_</span>answer<span class="built_in">_</span>list<span class="built_in">_</span>seq<span class="keyword">\_</span><span class="built_in">_</span>choice<span class="built_in">_</span>amount<span class="built_in">_</span>int</span><br><span class="line">  <span class="keyword">\int_use:N</span> <span class="keyword">\_</span><span class="built_in">_</span>choice<span class="built_in">_</span>amount<span class="built_in">_</span>int </span><br><span class="line">      <span class="keyword">\quad</span> B:<span class="keyword">\regex_count:nVN</span>&#123;B&#125;<span class="keyword">\_</span><span class="built_in">_</span>answer<span class="built_in">_</span>list<span class="built_in">_</span>seq<span class="keyword">\_</span><span class="built_in">_</span>choice<span class="built_in">_</span>amount<span class="built_in">_</span>int</span><br><span class="line">  <span class="keyword">\int_use:N</span> <span class="keyword">\_</span><span class="built_in">_</span>choice<span class="built_in">_</span>amount<span class="built_in">_</span>int </span><br><span class="line">      <span class="keyword">\quad</span> C:<span class="keyword">\regex_count:nVN</span>&#123;C&#125;<span class="keyword">\_</span><span class="built_in">_</span>answer<span class="built_in">_</span>list<span class="built_in">_</span>seq<span class="keyword">\_</span><span class="built_in">_</span>choice<span class="built_in">_</span>amount<span class="built_in">_</span>int</span><br><span class="line">  <span class="keyword">\int_use:N</span> <span class="keyword">\_</span><span class="built_in">_</span>choice<span class="built_in">_</span>amount<span class="built_in">_</span>int </span><br><span class="line">      <span class="keyword">\quad</span> D:<span class="keyword">\regex_count:nVN</span>&#123;D&#125;<span class="keyword">\_</span><span class="built_in">_</span>answer<span class="built_in">_</span>list<span class="built_in">_</span>seq<span class="keyword">\_</span><span class="built_in">_</span>choice<span class="built_in">_</span>amount<span class="built_in">_</span>int</span><br><span class="line">  <span class="keyword">\int_use:N</span> <span class="keyword">\_</span><span class="built_in">_</span>choice<span class="built_in">_</span>amount<span class="built_in">_</span>int</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">\choice</span>[A]&#123;A&#125;&#123;B&#125;&#123;C&#125;&#123;D&#125;</span><br><span class="line"><span class="keyword">\choice</span>[B]&#123;A&#125;&#123;B&#125;&#123;C&#125;&#123;D&#125;</span><br><span class="line"><span class="keyword">\choice</span>[C]&#123;A&#125;&#123;B&#125;&#123;C&#125;&#123;D&#125;</span><br><span class="line"><span class="keyword">\choice</span>[A]&#123;A&#125;&#123;B&#125;&#123;C&#125;&#123;D&#125;</span><br><span class="line"><span class="keyword">\choice</span>[C]&#123;A&#125;&#123;B&#125;&#123;C&#125;&#123;D&#125;</span><br><span class="line"><span class="keyword">\choice</span>[D]&#123;A&#125;&#123;B&#125;&#123;C&#125;&#123;D&#125;</span><br><span class="line"><span class="keyword">\choice</span>[B]&#123;A&#125;&#123;B&#125;&#123;C&#125;&#123;D&#125;</span><br><span class="line"><span class="keyword">\choice</span>[A]&#123;A&#125;&#123;B&#125;&#123;C&#125;&#123;D&#125;</span><br><span class="line"><span class="keyword">\choice</span>[D]&#123;A&#125;&#123;B&#125;&#123;C&#125;&#123;D&#125;</span><br><span class="line"><span class="keyword">\choice</span>[B]&#123;A&#125;&#123;B&#125;&#123;C&#125;&#123;D&#125;</span><br><span class="line"><span class="keyword">\par</span> </span><br><span class="line"><span class="keyword">\vspace</span>*&#123;2cm&#125;</span><br><span class="line"><span class="keyword">\answerlists</span></span><br><span class="line"><span class="keyword">\par</span> </span><br><span class="line"><span class="keyword">\choicescount</span></span><br><span class="line"><span class="keyword">\ExplSyntaxOff</span></span><br><span class="line"><span class="keyword">\end</span>&#123;document&#125;</span><br></pre></td></tr></table></figure>

<h2 id="输出结果"><a href="#输出结果" class="headerlink" title="输出结果"></a>输出结果</h2><p><img src="https://ljguo-1308058910.cos.ap-nanjing.myqcloud.com//img/QQ%E6%88%AA%E5%9B%BE20220217130337.png"></p>
<h2 id="样式加强"><a href="#样式加强" class="headerlink" title="样式加强"></a>样式加强</h2><p>我们还可以修改一下输出样式</p>
<p>效果图如下</p>
<p><img src="https://ljguo-1308058910.cos.ap-nanjing.myqcloud.com//img/QQ%E6%88%AA%E5%9B%BE20220217132609.png"></p>
<p>我们修改一下 <code>\answerlists</code> 命令</p>
<figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">\NewDocumentCommand</span>&#123;<span class="keyword">\answerlists</span>&#125;&#123;s&#125;</span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">\IfBooleanTF</span>&#123;<span class="params">#1</span>&#125;</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">\int_step_inline:nn</span>&#123;<span class="keyword">\seq_count:N</span> <span class="keyword">\_</span><span class="built_in">_</span>answer<span class="built_in">_</span>list<span class="built_in">_</span>seq&#125;</span><br><span class="line">    &#123;<span class="keyword">\seq_put_right:Nn</span> <span class="keyword">\_</span><span class="built_in">_</span>answer<span class="built_in">_</span>amount<span class="built_in">_</span>seq&#123;<span class="params">##1</span>&#125;&#125;</span><br><span class="line">    <span class="keyword">\begin</span>&#123;tabularx&#125;&#123;<span class="keyword">\seq_count:N</span> <span class="keyword">\_</span><span class="built_in">_</span>answer<span class="built_in">_</span>list<span class="built_in">_</span>seq cm&#125;</span><br><span class="line">      &#123;|*&#123;<span class="keyword">\seq_count:N</span> <span class="keyword">\_</span><span class="built_in">_</span>answer<span class="built_in">_</span>list<span class="built_in">_</span>seq&#125;&#123;&gt;&#123;<span class="keyword">\centering</span><span class="keyword">\arraybackslash</span>&#125;X|&#125;&#125;</span><br><span class="line">      <span class="keyword">\hline</span></span><br><span class="line">      <span class="keyword">\seq_use:Nn</span> <span class="keyword">\_</span><span class="built_in">_</span>answer<span class="built_in">_</span>amount<span class="built_in">_</span>seq&#123;<span class="built_in">&amp;</span>&#125;<span class="keyword">\\</span> <span class="keyword">\hline</span></span><br><span class="line">      <span class="keyword">\seq_use:Nn</span> <span class="keyword">\_</span><span class="built_in">_</span>answer<span class="built_in">_</span>list<span class="built_in">_</span>seq&#123;<span class="built_in">&amp;</span>&#125;<span class="keyword">\\</span> <span class="keyword">\hline</span></span><br><span class="line">    <span class="keyword">\end</span>&#123;tabularx&#125;</span><br><span class="line">  &#125;</span><br><span class="line">  &#123;</span><br><span class="line">    答案列表:~<span class="keyword">\int_step_inline:nnn</span>&#123;1&#125;&#123;<span class="keyword">\seq_count:N</span> <span class="keyword">\_</span><span class="built_in">_</span>answer<span class="built_in">_</span>list<span class="built_in">_</span>seq&#125;</span><br><span class="line">    &#123;<span class="params">##1</span>.<span class="keyword">\seq_item:Nn</span><span class="keyword">\_</span><span class="built_in">_</span>answer<span class="built_in">_</span>list<span class="built_in">_</span>seq&#123;<span class="params">##1</span>&#125;~&#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>可以发现增加了</p>
<figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">\int_step_inline:nn</span>&#123;<span class="keyword">\seq_count:N</span> <span class="keyword">\_</span><span class="built_in">_</span>answer<span class="built_in">_</span>list<span class="built_in">_</span>seq&#125;</span><br><span class="line">&#123;<span class="keyword">\seq_put_right:Nn</span> <span class="keyword">\_</span><span class="built_in">_</span>answer<span class="built_in">_</span>amount<span class="built_in">_</span>seq&#123;<span class="params">##1</span>&#125;&#125;</span><br><span class="line"><span class="keyword">\begin</span>&#123;tabularx&#125;&#123;<span class="keyword">\seq_count:N</span> <span class="keyword">\_</span><span class="built_in">_</span>answer<span class="built_in">_</span>list<span class="built_in">_</span>seq cm&#125;</span><br><span class="line">  &#123;|*&#123;<span class="keyword">\seq_count:N</span> <span class="keyword">\_</span><span class="built_in">_</span>answer<span class="built_in">_</span>list<span class="built_in">_</span>seq&#125;&#123;&gt;&#123;<span class="keyword">\centering</span><span class="keyword">\arraybackslash</span>&#125;X|&#125;&#125;</span><br><span class="line">  <span class="keyword">\hline</span></span><br><span class="line">  <span class="keyword">\seq_use:Nn</span> <span class="keyword">\_</span><span class="built_in">_</span>answer<span class="built_in">_</span>amount<span class="built_in">_</span>seq&#123;<span class="built_in">&amp;</span>&#125;<span class="keyword">\\</span> <span class="keyword">\hline</span></span><br><span class="line">  <span class="keyword">\seq_use:Nn</span> <span class="keyword">\_</span><span class="built_in">_</span>answer<span class="built_in">_</span>list<span class="built_in">_</span>seq&#123;<span class="built_in">&amp;</span>&#125;  <span class="keyword">\\</span> <span class="keyword">\hline</span></span><br><span class="line"><span class="keyword">\end</span>&#123;tabularx&#125;</span><br></pre></td></tr></table></figure>

<p>观察前两行代码，这里是通过 <code>\int_step_inline:nn</code> 构建了一个序列，这个序列<code>\__answer_amount_seq</code> 的值为<code>1234 ... \seq_count:N \__answer_list_seq</code> ，随后使用 <code>tabularx</code> 环境来排版这个表格，同时需要 <code>\usepackage&#123;tabularx&#125;</code> 宏包的支持</p>
<p>然后就是 <code>\seq_use:Nn</code> 这个函数，是用来将序列的值通过某个 <strong>token</strong> 连接起来，例如，此时 <code>\__answer_list_seq</code> 的值为 <code>ABCDAC</code> ，那么使用 <code>\seq_use:Nn \__answer_list_seq&#123;&amp;&#125;</code> 后，将被扩展为</p>
<blockquote>
<p>A &amp; B &amp; C &amp; D &amp; A &amp; C   </p>
</blockquote>
<p>同时，我们也修改 <code>\choicescount</code> 命令</p>
<figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">\NewDocumentCommand</span>&#123;<span class="keyword">\choicescount</span>&#125;&#123;s&#125;</span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">\IfBooleanTF</span>&#123;<span class="params">#1</span>&#125;</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">\begin</span>&#123;tabular&#125;&#123;|c|c|c|c|c|&#125;</span><br><span class="line">      <span class="keyword">\hline</span></span><br><span class="line">      选项 <span class="built_in">&amp;</span> A <span class="built_in">&amp;</span> B <span class="built_in">&amp;</span> C <span class="built_in">&amp;</span> D <span class="keyword">\\</span><span class="keyword">\hline</span></span><br><span class="line">      计数 </span><br><span class="line">      <span class="built_in">&amp;</span> <span class="keyword">\regex_count:nVN</span>&#123;A&#125;<span class="keyword">\_</span><span class="built_in">_</span>answer<span class="built_in">_</span>list<span class="built_in">_</span>seq<span class="keyword">\_</span><span class="built_in">_</span>choice<span class="built_in">_</span>amount<span class="built_in">_</span>int</span><br><span class="line">        <span class="keyword">\int_use:N</span> <span class="keyword">\_</span><span class="built_in">_</span>choice<span class="built_in">_</span>amount<span class="built_in">_</span>int </span><br><span class="line">      <span class="built_in">&amp;</span> <span class="keyword">\regex_count:nVN</span>&#123;B&#125;<span class="keyword">\_</span><span class="built_in">_</span>answer<span class="built_in">_</span>list<span class="built_in">_</span>seq<span class="keyword">\_</span><span class="built_in">_</span>choice<span class="built_in">_</span>amount<span class="built_in">_</span>int</span><br><span class="line">        <span class="keyword">\int_use:N</span> <span class="keyword">\_</span><span class="built_in">_</span>choice<span class="built_in">_</span>amount<span class="built_in">_</span>int</span><br><span class="line">      <span class="built_in">&amp;</span> <span class="keyword">\regex_count:nVN</span>&#123;C&#125;<span class="keyword">\_</span><span class="built_in">_</span>answer<span class="built_in">_</span>list<span class="built_in">_</span>seq<span class="keyword">\_</span><span class="built_in">_</span>choice<span class="built_in">_</span>amount<span class="built_in">_</span>int</span><br><span class="line">        <span class="keyword">\int_use:N</span> <span class="keyword">\_</span><span class="built_in">_</span>choice<span class="built_in">_</span>amount<span class="built_in">_</span>int</span><br><span class="line">      <span class="built_in">&amp;</span> <span class="keyword">\regex_count:nVN</span>&#123;D&#125;<span class="keyword">\_</span><span class="built_in">_</span>answer<span class="built_in">_</span>list<span class="built_in">_</span>seq<span class="keyword">\_</span><span class="built_in">_</span>choice<span class="built_in">_</span>amount<span class="built_in">_</span>int</span><br><span class="line">        <span class="keyword">\int_use:N</span> <span class="keyword">\_</span><span class="built_in">_</span>choice<span class="built_in">_</span>amount<span class="built_in">_</span>int <span class="keyword">\\</span> <span class="keyword">\hline</span></span><br><span class="line">    <span class="keyword">\end</span>&#123;tabular&#125;</span><br><span class="line">  &#125;</span><br><span class="line">  &#123;</span><br><span class="line">    选项计数: ~A:<span class="keyword">\regex_count:nVN</span>&#123;A&#125;<span class="keyword">\_</span><span class="built_in">_</span>answer<span class="built_in">_</span>list<span class="built_in">_</span>seq<span class="keyword">\_</span><span class="built_in">_</span>choice<span class="built_in">_</span>amount<span class="built_in">_</span>int</span><br><span class="line">  <span class="keyword">\int_use:N</span> <span class="keyword">\_</span><span class="built_in">_</span>choice<span class="built_in">_</span>amount<span class="built_in">_</span>int </span><br><span class="line">      <span class="keyword">\quad</span> B:<span class="keyword">\regex_count:nVN</span>&#123;B&#125;<span class="keyword">\_</span><span class="built_in">_</span>answer<span class="built_in">_</span>list<span class="built_in">_</span>seq<span class="keyword">\_</span><span class="built_in">_</span>choice<span class="built_in">_</span>amount<span class="built_in">_</span>int</span><br><span class="line">  <span class="keyword">\int_use:N</span> <span class="keyword">\_</span><span class="built_in">_</span>choice<span class="built_in">_</span>amount<span class="built_in">_</span>int </span><br><span class="line">      <span class="keyword">\quad</span> C:<span class="keyword">\regex_count:nVN</span>&#123;C&#125;<span class="keyword">\_</span><span class="built_in">_</span>answer<span class="built_in">_</span>list<span class="built_in">_</span>seq<span class="keyword">\_</span><span class="built_in">_</span>choice<span class="built_in">_</span>amount<span class="built_in">_</span>int</span><br><span class="line">  <span class="keyword">\int_use:N</span> <span class="keyword">\_</span><span class="built_in">_</span>choice<span class="built_in">_</span>amount<span class="built_in">_</span>int </span><br><span class="line">      <span class="keyword">\quad</span> D:<span class="keyword">\regex_count:nVN</span>&#123;D&#125;<span class="keyword">\_</span><span class="built_in">_</span>answer<span class="built_in">_</span>list<span class="built_in">_</span>seq<span class="keyword">\_</span><span class="built_in">_</span>choice<span class="built_in">_</span>amount<span class="built_in">_</span>int</span><br><span class="line">  <span class="keyword">\int_use:N</span> <span class="keyword">\_</span><span class="built_in">_</span>choice<span class="built_in">_</span>amount<span class="built_in">_</span>int</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>关于 <code>\NewDocumentCommand</code> 中的参数规范 <code>s</code> 可自行查阅 <code>xparse</code> 宏包用户说明文档</p>
<p>通过前面的工作我们构建了四个命令，分别是</p>
<ul>
<li><p>\answerlists</p>
</li>
<li><p>\answerlists*</p>
</li>
<li><p>\choicescount</p>
</li>
<li><p>\choicescount*</p>
</li>
</ul>
<p>带星号的命令用于输出表格形式</p>
<h2 id="加强完整源码"><a href="#加强完整源码" class="headerlink" title="加强完整源码"></a>加强完整源码</h2><figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">\documentclass</span>&#123;ctexart&#125;</span><br><span class="line"><span class="keyword">\usepackage</span>&#123;geometry,tabularx&#125;</span><br><span class="line"><span class="keyword">\geometry</span>&#123;margin=2cm&#125;</span><br><span class="line"><span class="keyword">\begin</span>&#123;document&#125;</span><br><span class="line"><span class="keyword">\input</span>&#123;choice.tex&#125;</span><br><span class="line"><span class="keyword">\ExplSyntaxOn</span></span><br><span class="line"><span class="keyword">\seq_clear_new:N</span> <span class="keyword">\_</span><span class="built_in">_</span>answer<span class="built_in">_</span>list<span class="built_in">_</span>seq</span><br><span class="line"><span class="keyword">\seq_clear_new:N</span> <span class="keyword">\_</span><span class="built_in">_</span>answer<span class="built_in">_</span>amount<span class="built_in">_</span>seq</span><br><span class="line"><span class="keyword">\int_zero_new:N</span> <span class="keyword">\_</span><span class="built_in">_</span>choice<span class="built_in">_</span>amount<span class="built_in">_</span>int</span><br><span class="line"><span class="keyword">\cs_generate_variant:Nn</span><span class="keyword">\regex_count:nnN</span>&#123;nVN&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">\NewDocumentCommand</span>&#123;<span class="keyword">\choices</span>&#125;&#123;ommmm&#125;</span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">\IfNoValueTF</span>&#123;<span class="params">#1</span>&#125;&#123;<span class="keyword">\seq_put_right:Nn</span><span class="keyword">\_</span><span class="built_in">_</span>answer<span class="built_in">_</span>list<span class="built_in">_</span>seq&#123;<span class="keyword">\space</span>&#125;&#125;&#123;<span class="keyword">\seq_put_right:Nn</span><span class="keyword">\_</span><span class="built_in">_</span>answer<span class="built_in">_</span>list<span class="built_in">_</span>seq&#123;<span class="params">#1</span>&#125;&#125;</span><br><span class="line">  <span class="keyword">\choice</span>&#123;<span class="params">#2</span>&#125;&#123;<span class="params">#3</span>&#125;&#123;<span class="params">#4</span>&#125;&#123;<span class="params">#5</span>&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">\NewDocumentCommand</span>&#123;<span class="keyword">\answerlist</span>&#125;&#123;s&#125;</span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">\IfBooleanTF</span>&#123;<span class="params">#1</span>&#125;</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">\int_step_inline:nn</span>&#123;<span class="keyword">\seq_count:N</span> <span class="keyword">\_</span><span class="built_in">_</span>answer<span class="built_in">_</span>list<span class="built_in">_</span>seq&#125;</span><br><span class="line">    &#123;<span class="keyword">\seq_put_right:Nn</span> <span class="keyword">\_</span><span class="built_in">_</span>answer<span class="built_in">_</span>amount<span class="built_in">_</span>seq&#123;<span class="params">##1</span>&#125;&#125;</span><br><span class="line">    <span class="keyword">\begin</span>&#123;tabularx&#125;&#123;<span class="keyword">\seq_count:N</span> <span class="keyword">\_</span><span class="built_in">_</span>answer<span class="built_in">_</span>list<span class="built_in">_</span>seq cm&#125;</span><br><span class="line">      &#123;|*&#123;<span class="keyword">\seq_count:N</span> <span class="keyword">\_</span><span class="built_in">_</span>answer<span class="built_in">_</span>list<span class="built_in">_</span>seq&#125;&#123;&gt;&#123;<span class="keyword">\centering</span><span class="keyword">\arraybackslash</span>&#125;X|&#125;&#125;</span><br><span class="line">      <span class="keyword">\hline</span></span><br><span class="line">      <span class="keyword">\seq_use:Nn</span> <span class="keyword">\_</span><span class="built_in">_</span>answer<span class="built_in">_</span>amount<span class="built_in">_</span>seq&#123;<span class="built_in">&amp;</span>&#125;<span class="keyword">\\</span> <span class="keyword">\hline</span></span><br><span class="line">      <span class="keyword">\seq_use:Nn</span> <span class="keyword">\_</span><span class="built_in">_</span>answer<span class="built_in">_</span>list<span class="built_in">_</span>seq&#123;<span class="built_in">&amp;</span>&#125;<span class="keyword">\\</span> <span class="keyword">\hline</span></span><br><span class="line">    <span class="keyword">\end</span>&#123;tabularx&#125;</span><br><span class="line">  &#125;</span><br><span class="line">  &#123;</span><br><span class="line">    答案列表:~<span class="keyword">\int_step_inline:nnn</span>&#123;1&#125;&#123;<span class="keyword">\seq_count:N</span> <span class="keyword">\_</span><span class="built_in">_</span>answer<span class="built_in">_</span>list<span class="built_in">_</span>seq&#125;</span><br><span class="line">    &#123;<span class="params">##1</span>.<span class="keyword">\seq_item:Nn</span><span class="keyword">\_</span><span class="built_in">_</span>answer<span class="built_in">_</span>list<span class="built_in">_</span>seq&#123;<span class="params">##1</span>&#125;~&#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">\NewDocumentCommand</span>&#123;<span class="keyword">\choicecount</span>&#125;&#123;s&#125;</span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">\IfBooleanTF</span>&#123;<span class="params">#1</span>&#125;</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">\begin</span>&#123;tabular&#125;&#123;|c|c|c|c|c|&#125;</span><br><span class="line">      <span class="keyword">\hline</span></span><br><span class="line">      选项 <span class="built_in">&amp;</span> A <span class="built_in">&amp;</span> B <span class="built_in">&amp;</span> C <span class="built_in">&amp;</span> D <span class="keyword">\\</span><span class="keyword">\hline</span></span><br><span class="line">      计数 </span><br><span class="line">      <span class="built_in">&amp;</span> <span class="keyword">\regex_count:nVN</span>&#123;A&#125;<span class="keyword">\_</span><span class="built_in">_</span>answer<span class="built_in">_</span>list<span class="built_in">_</span>seq<span class="keyword">\_</span><span class="built_in">_</span>choice<span class="built_in">_</span>amount<span class="built_in">_</span>int</span><br><span class="line">        <span class="keyword">\int_use:N</span> <span class="keyword">\_</span><span class="built_in">_</span>choice<span class="built_in">_</span>amount<span class="built_in">_</span>int </span><br><span class="line">      <span class="built_in">&amp;</span> <span class="keyword">\regex_count:nVN</span>&#123;B&#125;<span class="keyword">\_</span><span class="built_in">_</span>answer<span class="built_in">_</span>list<span class="built_in">_</span>seq<span class="keyword">\_</span><span class="built_in">_</span>choice<span class="built_in">_</span>amount<span class="built_in">_</span>int</span><br><span class="line">        <span class="keyword">\int_use:N</span> <span class="keyword">\_</span><span class="built_in">_</span>choice<span class="built_in">_</span>amount<span class="built_in">_</span>int</span><br><span class="line">      <span class="built_in">&amp;</span> <span class="keyword">\regex_count:nVN</span>&#123;C&#125;<span class="keyword">\_</span><span class="built_in">_</span>answer<span class="built_in">_</span>list<span class="built_in">_</span>seq<span class="keyword">\_</span><span class="built_in">_</span>choice<span class="built_in">_</span>amount<span class="built_in">_</span>int</span><br><span class="line">        <span class="keyword">\int_use:N</span> <span class="keyword">\_</span><span class="built_in">_</span>choice<span class="built_in">_</span>amount<span class="built_in">_</span>int</span><br><span class="line">      <span class="built_in">&amp;</span> <span class="keyword">\regex_count:nVN</span>&#123;D&#125;<span class="keyword">\_</span><span class="built_in">_</span>answer<span class="built_in">_</span>list<span class="built_in">_</span>seq<span class="keyword">\_</span><span class="built_in">_</span>choice<span class="built_in">_</span>amount<span class="built_in">_</span>int</span><br><span class="line">        <span class="keyword">\int_use:N</span> <span class="keyword">\_</span><span class="built_in">_</span>choice<span class="built_in">_</span>amount<span class="built_in">_</span>int <span class="keyword">\\</span> <span class="keyword">\hline</span></span><br><span class="line">    <span class="keyword">\end</span>&#123;tabular&#125;</span><br><span class="line">  &#125;</span><br><span class="line">  &#123;</span><br><span class="line">    选项计数: ~A:<span class="keyword">\regex_count:nVN</span>&#123;A&#125;<span class="keyword">\_</span><span class="built_in">_</span>answer<span class="built_in">_</span>list<span class="built_in">_</span>seq<span class="keyword">\_</span><span class="built_in">_</span>choice<span class="built_in">_</span>amount<span class="built_in">_</span>int</span><br><span class="line">  <span class="keyword">\int_use:N</span> <span class="keyword">\_</span><span class="built_in">_</span>choice<span class="built_in">_</span>amount<span class="built_in">_</span>int </span><br><span class="line">      <span class="keyword">\quad</span> B:<span class="keyword">\regex_count:nVN</span>&#123;B&#125;<span class="keyword">\_</span><span class="built_in">_</span>answer<span class="built_in">_</span>list<span class="built_in">_</span>seq<span class="keyword">\_</span><span class="built_in">_</span>choice<span class="built_in">_</span>amount<span class="built_in">_</span>int</span><br><span class="line">  <span class="keyword">\int_use:N</span> <span class="keyword">\_</span><span class="built_in">_</span>choice<span class="built_in">_</span>amount<span class="built_in">_</span>int </span><br><span class="line">      <span class="keyword">\quad</span> C:<span class="keyword">\regex_count:nVN</span>&#123;C&#125;<span class="keyword">\_</span><span class="built_in">_</span>answer<span class="built_in">_</span>list<span class="built_in">_</span>seq<span class="keyword">\_</span><span class="built_in">_</span>choice<span class="built_in">_</span>amount<span class="built_in">_</span>int</span><br><span class="line">  <span class="keyword">\int_use:N</span> <span class="keyword">\_</span><span class="built_in">_</span>choice<span class="built_in">_</span>amount<span class="built_in">_</span>int </span><br><span class="line">      <span class="keyword">\quad</span> D:<span class="keyword">\regex_count:nVN</span>&#123;D&#125;<span class="keyword">\_</span><span class="built_in">_</span>answer<span class="built_in">_</span>list<span class="built_in">_</span>seq<span class="keyword">\_</span><span class="built_in">_</span>choice<span class="built_in">_</span>amount<span class="built_in">_</span>int</span><br><span class="line">  <span class="keyword">\int_use:N</span> <span class="keyword">\_</span><span class="built_in">_</span>choice<span class="built_in">_</span>amount<span class="built_in">_</span>int</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">\choices</span>[A]&#123;A&#125;&#123;B&#125;&#123;C&#125;&#123;D&#125;</span><br><span class="line"><span class="keyword">\choices</span>[B]&#123;A&#125;&#123;B&#125;&#123;C&#125;&#123;D&#125;</span><br><span class="line"><span class="keyword">\choices</span>[C]&#123;A&#125;&#123;B&#125;&#123;C&#125;&#123;D&#125;</span><br><span class="line"><span class="keyword">\choices</span>[A]&#123;A&#125;&#123;B&#125;&#123;C&#125;&#123;D&#125;</span><br><span class="line"><span class="keyword">\choices</span>[C]&#123;A&#125;&#123;B&#125;&#123;C&#125;&#123;D&#125;</span><br><span class="line"><span class="keyword">\choices</span>[D]&#123;A&#125;&#123;B&#125;&#123;C&#125;&#123;D&#125;</span><br><span class="line"><span class="keyword">\choices</span>[B]&#123;A&#125;&#123;B&#125;&#123;C&#125;&#123;D&#125;</span><br><span class="line"><span class="keyword">\choices</span>[A]&#123;A&#125;&#123;B&#125;&#123;C&#125;&#123;D&#125;</span><br><span class="line"><span class="keyword">\choices</span>[D]&#123;A&#125;&#123;B&#125;&#123;C&#125;&#123;D&#125;</span><br><span class="line"><span class="keyword">\choices</span>[B]&#123;A&#125;&#123;B&#125;&#123;C&#125;&#123;D&#125;</span><br><span class="line"><span class="keyword">\par</span> </span><br><span class="line"><span class="keyword">\vspace</span>*&#123;2cm&#125;</span><br><span class="line"><span class="keyword">\centering</span></span><br><span class="line"><span class="keyword">\answerlist</span>*</span><br><span class="line"><span class="keyword">\par</span> </span><br><span class="line"><span class="keyword">\choicecount</span>*</span><br><span class="line"><span class="keyword">\ExplSyntaxOff</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">\end</span>&#123;document&#125;</span><br></pre></td></tr></table></figure>

<h2 id="输出结果-1"><a href="#输出结果-1" class="headerlink" title="输出结果"></a>输出结果</h2><p><img src="https://raw.githubusercontent.com/ljguo1020/Images/main/img/QQ%E6%88%AA%E5%9B%BE20220217132609.png"></p>
<hr>
<p>好了，就到这儿叭，我们下期再见啦 ~</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://example.com/1970/01/01/LaTeX-choice-box/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="ljguo">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="LJGUO">
      <meta itemprop="description" content="学习交流">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | LJGUO">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/1970/01/01/LaTeX-choice-box/" class="post-title-link" itemprop="url">实现一个复选列表效果</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：1970-01-01 08:00:00" itemprop="dateCreated datePublished" datetime="1970-01-01T08:00:00+08:00">1970-01-01</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2022-11-11 22:44:15" itemprop="dateModified" datetime="2022-11-11T22:44:15+08:00">2022-11-11</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/LaTeX/" itemprop="url" rel="index"><span itemprop="name">LaTeX</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h2 id="想法来源"><a href="#想法来源" class="headerlink" title="想法来源"></a>想法来源</h2><p>今天下午在配置我的博客时，看到了这样一种效果</p>
<p><img src="https://ljguo-1308058910.cos.ap-nanjing.myqcloud.com//img/LaTeX_choice_box1.png"></p>
<p>于是想着用 LaTeX 来实现一下</p>
<h3 id="需要实现的功能"><a href="#需要实现的功能" class="headerlink" title="需要实现的功能"></a>需要实现的功能</h3><ul>
<li>定义一个环境，命名为 <code>test </code> ,并接受一些键值<ul>
<li>colorlist &#x3D; {color1,color2,color3, … }, 用于设置各个选择框的颜色</li>
<li>color &#x3D; colorname, 用于接受一个颜色，指定下列所有选择框为同一颜色</li>
<li>scale &#x3D;  fp ,用于对框大小进行缩放</li>
<li>style &#x3D; ,用于设置框的样式</li>
</ul>
</li>
<li>(在<code>test</code>环境中)重新定义 <code>\item</code> 命令 和 <code>\item*</code> 命令，分别用于制定空框和选择框</li>
<li><code>\item</code> 可以接受一个可选参数，即 <code>\item[]</code> <code>\item*[]</code> ,这个可选参数可以设置键值<ul>
<li>设置当前框颜色</li>
<li>style &#x3D; ,  设置当前框样式</li>
</ul>
</li>
</ul>
<h2 id="开始动手"><a href="#开始动手" class="headerlink" title="开始动手"></a>开始动手</h2><h3 id="预定义变量"><a href="#预定义变量" class="headerlink" title="预定义变量"></a>预定义变量</h3><figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">\int_zero_new:N</span> <span class="keyword">\_</span><span class="built_in">_</span>item<span class="built_in">_</span>int <span class="comment">% 用于为 \item 命令设置计数器</span></span><br></pre></td></tr></table></figure>

<h3 id="使用-l3draw-来绘制两种框"><a href="#使用-l3draw-来绘制两种框" class="headerlink" title="使用 l3draw 来绘制两种框"></a>使用 <code>l3draw</code> 来绘制两种框</h3><ol>
<li><code>\__item_true_label:</code> 选择样式</li>
</ol>
<figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">\cs_new:Npn</span> <span class="keyword">\__item_true_label:</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">\draw_begin:</span></span><br><span class="line">    <span class="keyword">\draw_baseline:n</span>&#123;0.5ex&#125;</span><br><span class="line">    <span class="keyword">\draw_path_rectangle:nn</span>&#123;0,0&#125;&#123;0.4cm,0.4cm&#125;</span><br><span class="line">    <span class="keyword">\color_fill:x</span>&#123;<span class="keyword">\clist_item:Nn</span><span class="keyword">\_</span><span class="built_in">_</span>color<span class="built_in">_</span>clist&#123;<span class="keyword">\_</span><span class="built_in">_</span>item<span class="built_in">_</span>int&#125;&#125;</span><br><span class="line">    <span class="keyword">\draw_path_use:n</span>&#123;fill&#125;</span><br><span class="line">    <span class="keyword">\draw_scope_begin:</span></span><br><span class="line">    <span class="keyword">\draw_cap_round:</span></span><br><span class="line">    <span class="keyword">\draw_join_round:</span></span><br><span class="line">    <span class="keyword">\color_select:n</span>&#123;white&#125;</span><br><span class="line">    <span class="keyword">\draw_path_moveto:n</span>&#123;0.1cm,0.21cm&#125;</span><br><span class="line">    <span class="keyword">\draw_path_lineto:n</span>&#123;0.18cm,0.08cm&#125;</span><br><span class="line">    <span class="keyword">\draw_path_lineto:n</span>&#123;0.32cm,0.32cm&#125;</span><br><span class="line">    <span class="keyword">\draw_linewidth:n</span>&#123;1pt&#125;</span><br><span class="line">    <span class="keyword">\draw_path_use:n</span>&#123;stroke&#125;</span><br><span class="line">    <span class="keyword">\draw_scope_end:</span></span><br><span class="line">    <span class="keyword">\draw_end:</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ol start="2">
<li><code>\__item_false_label:</code> 未选择样式</li>
</ol>
<figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">\cs_new:Npn</span> <span class="keyword">\__item_false_label:</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">\draw_begin:</span></span><br><span class="line">    <span class="keyword">\draw_baseline:n</span>&#123;0.5ex&#125;</span><br><span class="line">    <span class="keyword">\draw_linewidth:n</span>&#123;0.8pt&#125;</span><br><span class="line">    <span class="keyword">\draw_path_rectangle:nn</span>&#123;0,0&#125;&#123;0.4cm,0.4cm&#125;</span><br><span class="line">    <span class="keyword">\color_select:x</span>&#123;<span class="keyword">\clist_item:Nn</span><span class="keyword">\_</span><span class="built_in">_</span>color<span class="built_in">_</span>clist&#123;<span class="keyword">\_</span><span class="built_in">_</span>item<span class="built_in">_</span>int&#125;&#125;</span><br><span class="line">    <span class="keyword">\draw_path_use:n</span>&#123;stroke&#125;</span><br><span class="line">    <span class="keyword">\draw_end:</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>注意上面代码中有两个函数</p>
<figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">\color_select:x</span></span><br><span class="line"><span class="keyword">\color_fill:x</span></span><br></pre></td></tr></table></figure>

<p><strong>expl3</strong>  宏包为我们提供的是 <code>n</code> 变体，这里我们需要对它所接受的参数进行完全展开，于是我们定义一个 <code>x</code> 变体</p>
<figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">\cs_generate_variant:Nn</span><span class="keyword">\color_fill:n</span>&#123;x&#125;</span><br><span class="line"><span class="keyword">\cs_generate_variant:Nn</span><span class="keyword">\color_select:n</span>&#123;x&#125;</span><br></pre></td></tr></table></figure>

<h3 id="定义键值"><a href="#定义键值" class="headerlink" title="定义键值"></a>定义键值</h3><figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">\keys_define:nn</span>&#123;test&#125;</span><br><span class="line">&#123;</span><br><span class="line">  colorlist.clist<span class="built_in">_</span>set:N = <span class="keyword">\_</span><span class="built_in">_</span>color<span class="built_in">_</span>clist,   </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="定义-test-环境"><a href="#定义-test-环境" class="headerlink" title="定义 test 环境"></a>定义 <code>test</code> 环境</h3><figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">\NewDocumentEnvironment</span>&#123;test&#125;&#123;m&#125;</span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">\int_zero:N</span> <span class="keyword">\_</span><span class="built_in">_</span>item<span class="built_in">_</span>int        </span><br><span class="line">  <span class="keyword">\keys_set:nn</span>&#123;test&#125;&#123;<span class="params">#1</span>&#125;</span><br><span class="line">  <span class="keyword">\seq_set_from_clist:NN</span> <span class="keyword">\_</span><span class="built_in">_</span>color<span class="built_in">_</span>seq <span class="keyword">\_</span><span class="built_in">_</span>color<span class="built_in">_</span>clist       </span><br><span class="line">  <span class="keyword">\RenewDocumentCommand</span>&#123;<span class="keyword">\item</span>&#125;&#123;sm&#125;</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">\int_incr:N</span> <span class="keyword">\_</span><span class="built_in">_</span>item<span class="built_in">_</span>int</span><br><span class="line">    <span class="keyword">\IfBooleanTF</span>&#123;<span class="params">##1</span>&#125;</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">\__item_true_label:</span> <span class="keyword">\space</span> <span class="params">##2</span> <span class="keyword">\par</span></span><br><span class="line">    &#125;</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">\__item_false_label:</span> <span class="keyword">\space</span> <span class="params">##2</span> <span class="keyword">\par</span></span><br><span class="line">    &#125;</span><br><span class="line">    &#125;        </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>至此，暂时告一段落～</p>
<h2 id="完整源码"><a href="#完整源码" class="headerlink" title="完整源码"></a>完整源码</h2><figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">\documentclass</span>&#123;ctexart&#125;</span><br><span class="line"><span class="keyword">\usepackage</span>&#123;l3draw&#125;</span><br><span class="line"><span class="keyword">\begin</span>&#123;document&#125;</span><br><span class="line">    <span class="keyword">\ExplSyntaxOn</span></span><br><span class="line">    <span class="keyword">\int_zero_new:N</span> <span class="keyword">\_</span><span class="built_in">_</span>item<span class="built_in">_</span>int</span><br><span class="line">    <span class="keyword">\cs_generate_variant:Nn</span><span class="keyword">\color_fill:n</span>&#123;x&#125;</span><br><span class="line">    <span class="keyword">\cs_generate_variant:Nn</span><span class="keyword">\color_select:n</span>&#123;x&#125;</span><br><span class="line">    <span class="keyword">\cs_new:Npn</span> <span class="keyword">\__item_true_label:</span></span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">\draw_begin:</span></span><br><span class="line">      <span class="keyword">\draw_baseline:n</span>&#123;0.5ex&#125;</span><br><span class="line">      <span class="keyword">\draw_path_rectangle:nn</span>&#123;0,0&#125;&#123;0.4cm,0.4cm&#125;</span><br><span class="line">      <span class="keyword">\color_fill:x</span>&#123;<span class="keyword">\clist_item:Nn</span><span class="keyword">\_</span><span class="built_in">_</span>color<span class="built_in">_</span>clist&#123;<span class="keyword">\_</span><span class="built_in">_</span>item<span class="built_in">_</span>int&#125;&#125;</span><br><span class="line">      <span class="keyword">\draw_path_use:n</span>&#123;fill&#125;</span><br><span class="line">      <span class="keyword">\draw_scope_begin:</span></span><br><span class="line">      <span class="keyword">\draw_cap_round:</span></span><br><span class="line">      <span class="keyword">\draw_join_round:</span></span><br><span class="line">      <span class="keyword">\color_select:n</span>&#123;white&#125;</span><br><span class="line">      <span class="keyword">\draw_path_moveto:n</span>&#123;0.1cm,0.21cm&#125;</span><br><span class="line">      <span class="keyword">\draw_path_lineto:n</span>&#123;0.18cm,0.08cm&#125;</span><br><span class="line">      <span class="keyword">\draw_path_lineto:n</span>&#123;0.32cm,0.32cm&#125;</span><br><span class="line">      <span class="keyword">\draw_linewidth:n</span>&#123;1pt&#125;</span><br><span class="line">      <span class="keyword">\draw_path_use:n</span>&#123;stroke&#125;</span><br><span class="line">      <span class="keyword">\draw_scope_end:</span></span><br><span class="line">      <span class="keyword">\draw_end:</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">\cs_new:Npn</span> <span class="keyword">\__item_false_label:</span></span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">\draw_begin:</span></span><br><span class="line">      <span class="keyword">\draw_baseline:n</span>&#123;0.5ex&#125;</span><br><span class="line">      <span class="keyword">\draw_linewidth:n</span>&#123;0.8pt&#125;</span><br><span class="line">      <span class="keyword">\draw_path_rectangle:nn</span>&#123;0,0&#125;&#123;0.4cm,0.4cm&#125;</span><br><span class="line">      <span class="keyword">\color_select:x</span>&#123;<span class="keyword">\clist_item:Nn</span><span class="keyword">\_</span><span class="built_in">_</span>color<span class="built_in">_</span>clist&#123;<span class="keyword">\_</span><span class="built_in">_</span>item<span class="built_in">_</span>int&#125;&#125;</span><br><span class="line">      <span class="keyword">\draw_path_use:n</span>&#123;stroke&#125;</span><br><span class="line">      <span class="keyword">\draw_end:</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">\keys_define:nn</span>&#123;test&#125;</span><br><span class="line">    &#123;</span><br><span class="line">      colorlist.clist<span class="built_in">_</span>set:N = <span class="keyword">\_</span><span class="built_in">_</span>color<span class="built_in">_</span>clist,   </span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">\NewDocumentEnvironment</span>&#123;test&#125;&#123;m&#125;</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">\int_zero:N</span> <span class="keyword">\_</span><span class="built_in">_</span>item<span class="built_in">_</span>int        </span><br><span class="line">      <span class="keyword">\keys_set:nn</span>&#123;test&#125;&#123;<span class="params">#1</span>&#125;</span><br><span class="line">      <span class="keyword">\seq_set_from_clist:NN</span> <span class="keyword">\_</span><span class="built_in">_</span>color<span class="built_in">_</span>seq <span class="keyword">\_</span><span class="built_in">_</span>color<span class="built_in">_</span>clist       </span><br><span class="line">      <span class="keyword">\RenewDocumentCommand</span>&#123;<span class="keyword">\item</span>&#125;&#123;sm&#125;</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="keyword">\int_incr:N</span> <span class="keyword">\_</span><span class="built_in">_</span>item<span class="built_in">_</span>int</span><br><span class="line">        <span class="keyword">\IfBooleanTF</span>&#123;<span class="params">##1</span>&#125;</span><br><span class="line">        &#123;</span><br><span class="line">          <span class="keyword">\__item_true_label:</span> <span class="keyword">\space</span> <span class="params">##2</span> <span class="keyword">\par</span></span><br><span class="line">        &#125;</span><br><span class="line">        &#123;</span><br><span class="line">          <span class="keyword">\__item_false_label:</span> <span class="keyword">\space</span> <span class="params">##2</span> <span class="keyword">\par</span></span><br><span class="line">        &#125;</span><br><span class="line">     &#125;        </span><br><span class="line">    &#125;</span><br><span class="line">    &#123;<span class="keyword">\vspace</span>*&#123;0.5cm&#125;&#125;</span><br><span class="line">    <span class="keyword">\ExplSyntaxOff</span></span><br><span class="line">&#123;<span class="keyword">\LARGE</span><span class="keyword">\bfseries</span> 我喜欢？&#125;<span class="keyword">\par</span> </span><br><span class="line"><span class="keyword">\begin</span>&#123;test&#125;&#123;colorlist=&#123;green,cyan,red,blue,red,yellow,red&#125;&#125;</span><br><span class="line">  <span class="keyword">\item</span>*&#123;熬夜&#125; </span><br><span class="line">  <span class="keyword">\item</span>&#123;玩游戏&#125; </span><br><span class="line">  <span class="keyword">\item</span>*&#123;打羽毛球&#125; </span><br><span class="line">  <span class="keyword">\item</span>*&#123;LaTeX&#125;</span><br><span class="line">  <span class="keyword">\item</span>*&#123;听歌&#125;</span><br><span class="line">  <span class="keyword">\item</span>&#123;学习&#125;</span><br><span class="line">  <span class="keyword">\item</span>*&#123;熬夜玩游戏&#125;</span><br><span class="line"><span class="keyword">\end</span>&#123;test&#125; </span><br><span class="line"><span class="keyword">\end</span>&#123;document&#125;</span><br></pre></td></tr></table></figure>

<h2 id="输出结果"><a href="#输出结果" class="headerlink" title="输出结果"></a>输出结果</h2><p><img src="https://ljguo-1308058910.cos.ap-nanjing.myqcloud.com//img/LaTeX_choice_box2.png"></p>
<h2 id="未完结"><a href="#未完结" class="headerlink" title="未完结"></a>未完结</h2><p>还有些功能没有实现，后面再更新吧 ～ 现在是凌晨 02:55 先睡了～</p>
<hr>
<h2 id="继续"><a href="#继续" class="headerlink" title="继续"></a>继续</h2><p>我来继续更新啦~</p>
<p>我打算用 <code>l3coffin</code> 来实现了，最近看了一下这个模块，真的是非常厉害！</p>
<ul>
<li>首先我们需要对绘制的两种框代码做一点点修改</li>
</ul>
<ol>
<li><code>\__item_true_label:</code>  选择样式</li>
</ol>
<figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">\cs_new:Npn</span> <span class="keyword">\__item_true_label:</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">\draw_begin:</span></span><br><span class="line">  <span class="keyword">\draw_baseline:n</span>&#123;0.5ex&#125;</span><br><span class="line">  <span class="keyword">\draw_path_rectangle:nn</span>&#123;0,0&#125;&#123;0.4cm,0.4cm&#125;</span><br><span class="line">  <span class="keyword">\color_fill:x</span>&#123;<span class="keyword">\_</span><span class="built_in">_</span>color<span class="built_in">_</span>tl&#125;</span><br><span class="line">  <span class="keyword">\draw_path_use:n</span>&#123;fill&#125;</span><br><span class="line">  <span class="keyword">\draw_scope_begin:</span></span><br><span class="line">  <span class="keyword">\draw_cap_round:</span></span><br><span class="line">  <span class="keyword">\draw_join_round:</span></span><br><span class="line">  <span class="keyword">\color_select:n</span>&#123;white&#125;</span><br><span class="line">  <span class="keyword">\draw_path_moveto:n</span>&#123;0.1cm,0.21cm&#125;</span><br><span class="line">  <span class="keyword">\draw_path_lineto:n</span>&#123;0.18cm,0.08cm&#125;</span><br><span class="line">  <span class="keyword">\draw_path_lineto:n</span>&#123;0.32cm,0.32cm&#125;</span><br><span class="line">  <span class="keyword">\draw_linewidth:n</span>&#123;1pt&#125;</span><br><span class="line">  <span class="keyword">\draw_path_use:n</span>&#123;stroke&#125;</span><br><span class="line">  <span class="keyword">\draw_scope_end:</span></span><br><span class="line">  <span class="keyword">\draw_end:</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ol start="2">
<li><code>\__item_false_label:</code> 未选择样式</li>
</ol>
<figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">\cs_new:Npn</span> <span class="keyword">\__item_false_label:</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">\draw_begin:</span></span><br><span class="line">  <span class="keyword">\draw_baseline:n</span>&#123;0.5ex&#125;</span><br><span class="line">  <span class="keyword">\draw_linewidth:n</span>&#123;0.8pt&#125;</span><br><span class="line">  <span class="keyword">\draw_path_rectangle:nn</span>&#123;0,0&#125;&#123;0.4cm,0.4cm&#125;</span><br><span class="line">  <span class="keyword">\color_select:x</span>&#123;<span class="keyword">\_</span><span class="built_in">_</span>color<span class="built_in">_</span>tl&#125;</span><br><span class="line">  <span class="keyword">\draw_path_use:n</span>&#123;stroke&#125;</span><br><span class="line">  <span class="keyword">\draw_end:</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>定义两个函数来输出 <code>coffin</code></li>
</ul>
<ol>
<li><code>\__item_label: </code></li>
</ol>
<figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">\cs_new_protected:Npn</span> <span class="keyword">\__item_label:</span> </span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">\par</span></span><br><span class="line">  <span class="keyword">\int_compare:nF</span>&#123;<span class="keyword">\_</span><span class="built_in">_</span>item<span class="built_in">_</span>int = <span class="keyword">\c_zero_int</span>&#125;</span><br><span class="line">  &#123;</span><br><span class="line">	<span class="keyword">\__item_content:</span></span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">\int_incr:N</span> <span class="keyword">\_</span><span class="built_in">_</span>item<span class="built_in">_</span>int</span><br><span class="line">  <span class="keyword">\vcoffin_set:Nnx</span> <span class="keyword">\_</span><span class="built_in">_</span>label<span class="built_in">_</span>coffin &#123;1cm&#125;&#123;<span class="keyword">\_</span><span class="built_in">_</span>item<span class="built_in">_</span>tl&#125;</span><br><span class="line">  <span class="keyword">\vcoffin_set:Nnw</span> <span class="keyword">\_</span><span class="built_in">_</span>content<span class="built_in">_</span>coffin &#123;<span class="keyword">\textwidth</span> - <span class="keyword">\_</span><span class="built_in">_</span>parsep<span class="built_in">_</span>dim - 2cm&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ol start="2">
<li><code>\__item_content:</code></li>
</ol>
<figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">\cs_new_protected:Npn</span> <span class="keyword">\__item_content:</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">\vcoffin_set_end:</span></span><br><span class="line">  <span class="keyword">\coffin_join:NnnNnnnn</span> <span class="keyword">\_</span><span class="built_in">_</span>label<span class="built_in">_</span>coffin&#123;T&#125;&#123;r&#125;<span class="keyword">\_</span><span class="built_in">_</span>content<span class="built_in">_</span>coffin&#123;T&#125;&#123;l&#125;&#123;-10pt&#125;&#123;0pt&#125;</span><br><span class="line">  <span class="keyword">\coffin_typeset:Nnnnn</span> <span class="keyword">\_</span><span class="built_in">_</span>label<span class="built_in">_</span>coffin&#123;B&#125;&#123;l&#125;&#123;<span class="keyword">\_</span><span class="built_in">_</span>parsep<span class="built_in">_</span>dim&#125;&#123;<span class="keyword">\_</span><span class="built_in">_</span>vsep<span class="built_in">_</span>dim&#125;</span><br><span class="line">  <span class="keyword">\par</span> </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>定义键值</li>
</ul>
<figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">\keys_define:nn</span>&#123;test&#125;</span><br><span class="line">&#123;</span><br><span class="line">  colorlist.clist<span class="built_in">_</span>set:N = <span class="keyword">\_</span><span class="built_in">_</span>color<span class="built_in">_</span>clist, <span class="comment">% 用于设置颜色列表</span></span><br><span class="line">  vsep.dim<span class="built_in">_</span>set:N = <span class="keyword">\_</span><span class="built_in">_</span>vsep<span class="built_in">_</span>dim, <span class="comment">% 控制每个条目的垂直间距</span></span><br><span class="line">  vsep.initial:n = 1pt, <span class="comment">% 设置初始值</span></span><br><span class="line">  parsep.dim<span class="built_in">_</span>set:N = <span class="keyword">\_</span><span class="built_in">_</span>parsep<span class="built_in">_</span>dim, <span class="comment">% 控制每个条目整体水平的偏移量</span></span><br><span class="line">  parsep.initial:n = <span class="keyword">\_</span><span class="built_in">_</span>parindent<span class="built_in">_</span>dim, <span class="comment">% 设置初始值</span></span><br><span class="line">  color.str<span class="built_in">_</span>set:N = <span class="keyword">\_</span><span class="built_in">_</span>color<span class="built_in">_</span>str, <span class="comment">% 用于设置单个颜色</span></span><br><span class="line">  color.initial:n = black <span class="comment">% 设置初始值</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>提前申明变量和定义函数变体</li>
</ul>
<figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">\coffin_new:N</span> <span class="keyword">\_</span><span class="built_in">_</span>label<span class="built_in">_</span>coffin</span><br><span class="line"><span class="keyword">\coffin_new:N</span> <span class="keyword">\_</span><span class="built_in">_</span>output<span class="built_in">_</span>coffin</span><br><span class="line"><span class="keyword">\dim_zero_new:N</span> <span class="keyword">\_</span><span class="built_in">_</span>vsep<span class="built_in">_</span>dim</span><br><span class="line"><span class="keyword">\dim_zero_new:N</span> <span class="keyword">\_</span><span class="built_in">_</span>parsep<span class="built_in">_</span>dim</span><br><span class="line"><span class="keyword">\dim_zero_new:N</span> <span class="keyword">\_</span><span class="built_in">_</span>parindent<span class="built_in">_</span>dim</span><br><span class="line"><span class="keyword">\dim_set_eq:NN</span> <span class="keyword">\_</span><span class="built_in">_</span>parindent<span class="built_in">_</span>dim <span class="keyword">\parindent</span></span><br><span class="line"><span class="keyword">\tl_new:N</span> <span class="keyword">\_</span><span class="built_in">_</span>item<span class="built_in">_</span>tl</span><br><span class="line"><span class="keyword">\cs_generate_variant:Nn</span> <span class="keyword">\vcoffin_set:Nnn</span>&#123;Nnx&#125;</span><br><span class="line"><span class="keyword">\int_zero_new:N</span> <span class="keyword">\_</span><span class="built_in">_</span>item<span class="built_in">_</span>int</span><br><span class="line"><span class="keyword">\cs_generate_variant:Nn</span><span class="keyword">\color_fill:n</span>&#123;x&#125;</span><br><span class="line"><span class="keyword">\cs_generate_variant:Nn</span><span class="keyword">\color_select:n</span>&#123;x&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li><code>test</code> 环境</li>
</ul>
<figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">\NewDocumentEnvironment</span>&#123;test&#125;&#123;O&#123;&#125;&#125;</span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">\group_begin:</span> </span><br><span class="line">  <span class="keyword">\dim_set:Nn</span> <span class="keyword">\parindent</span>&#123;0pt&#125;</span><br><span class="line">  <span class="keyword">\int_zero:N</span> <span class="keyword">\_</span><span class="built_in">_</span>item<span class="built_in">_</span>int        </span><br><span class="line">  <span class="keyword">\keys_set:nn</span>&#123;test&#125;&#123;<span class="params">#1</span>&#125;</span><br><span class="line">  <span class="keyword">\seq_set_from_clist:NN</span> <span class="keyword">\_</span><span class="built_in">_</span>color<span class="built_in">_</span>seq <span class="keyword">\_</span><span class="built_in">_</span>color<span class="built_in">_</span>clist  </span><br><span class="line">  <span class="keyword">\clist_if_empty:NTF</span> <span class="keyword">\_</span><span class="built_in">_</span>color<span class="built_in">_</span>clist</span><br><span class="line">  &#123;</span><br><span class="line">	<span class="keyword">\tl_set:Nn</span><span class="keyword">\_</span><span class="built_in">_</span>color<span class="built_in">_</span>tl</span><br><span class="line">    &#123;<span class="keyword">\_</span><span class="built_in">_</span>color<span class="built_in">_</span>str&#125;</span><br><span class="line">  &#125;</span><br><span class="line">  &#123;</span><br><span class="line">	<span class="keyword">\tl_set:Nn</span><span class="keyword">\_</span><span class="built_in">_</span>color<span class="built_in">_</span>tl &#123;<span class="keyword">\clist_item:Nn</span><span class="keyword">\_</span><span class="built_in">_</span>color<span class="built_in">_</span>clist&#123;<span class="keyword">\_</span><span class="built_in">_</span>item<span class="built_in">_</span>int&#125;&#125;</span><br><span class="line">  &#125;     </span><br><span class="line">  <span class="keyword">\RenewDocumentCommand</span>&#123;<span class="keyword">\item</span>&#125;&#123;s&#125;</span><br><span class="line">  &#123;           </span><br><span class="line">    <span class="keyword">\IfBooleanTF</span>&#123;<span class="params">##1</span>&#125;</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">\tl_gset:Nn</span> <span class="keyword">\_</span><span class="built_in">_</span>item<span class="built_in">_</span>tl</span><br><span class="line">      &#123;<span class="keyword">\__item_true_label:</span>&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	&#123;</span><br><span class="line">	  <span class="keyword">\tl_gset:Nn</span> <span class="keyword">\_</span><span class="built_in">_</span>item<span class="built_in">_</span>tl</span><br><span class="line">	  &#123;</span><br><span class="line">		<span class="keyword">\__item_false_label:</span></span><br><span class="line">	  &#125; </span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">\__item_label:</span>					</span><br><span class="line">  &#125;          </span><br><span class="line">&#125;</span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">\__item_output:</span></span><br><span class="line">  <span class="keyword">\group_end:</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>这次就到这儿叭，后面在更新~</p>
<h2 id="完整源码-1"><a href="#完整源码-1" class="headerlink" title="完整源码"></a>完整源码</h2><figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">\documentclass</span>&#123;ctexart&#125;</span><br><span class="line"><span class="keyword">\usepackage</span>&#123;l3draw,expl3,xparse&#125;</span><br><span class="line"><span class="keyword">\ExplSyntaxOn</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">\coffin_new:N</span> <span class="keyword">\_</span><span class="built_in">_</span>label<span class="built_in">_</span>coffin</span><br><span class="line"><span class="keyword">\coffin_new:N</span> <span class="keyword">\_</span><span class="built_in">_</span>content<span class="built_in">_</span>coffin</span><br><span class="line"><span class="keyword">\dim_zero_new:N</span> <span class="keyword">\_</span><span class="built_in">_</span>vsep<span class="built_in">_</span>dim</span><br><span class="line"><span class="keyword">\dim_zero_new:N</span> <span class="keyword">\_</span><span class="built_in">_</span>parsep<span class="built_in">_</span>dim</span><br><span class="line"><span class="keyword">\dim_zero_new:N</span> <span class="keyword">\_</span><span class="built_in">_</span>parindent<span class="built_in">_</span>dim</span><br><span class="line"><span class="keyword">\dim_set_eq:NN</span> <span class="keyword">\_</span><span class="built_in">_</span>parindent<span class="built_in">_</span>dim <span class="keyword">\parindent</span></span><br><span class="line"><span class="keyword">\tl_new:N</span> <span class="keyword">\_</span><span class="built_in">_</span>item<span class="built_in">_</span>tl</span><br><span class="line"><span class="keyword">\cs_generate_variant:Nn</span> <span class="keyword">\vcoffin_set:Nnn</span>&#123;Nnx&#125;</span><br><span class="line"><span class="keyword">\int_zero_new:N</span> <span class="keyword">\_</span><span class="built_in">_</span>item<span class="built_in">_</span>int</span><br><span class="line"><span class="keyword">\cs_generate_variant:Nn</span><span class="keyword">\color_fill:n</span>&#123;x&#125;</span><br><span class="line"><span class="keyword">\cs_generate_variant:Nn</span><span class="keyword">\color_select:n</span>&#123;x&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">\cs_new:Npn</span> <span class="keyword">\__item_true_label:</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">\draw_begin:</span></span><br><span class="line">  <span class="keyword">\draw_baseline:n</span>&#123;0.5ex&#125;</span><br><span class="line">  <span class="keyword">\draw_path_rectangle:nn</span>&#123;0,0&#125;&#123;0.4cm,0.4cm&#125;</span><br><span class="line">  <span class="keyword">\color_fill:x</span>&#123;<span class="keyword">\_</span><span class="built_in">_</span>color<span class="built_in">_</span>tl&#125;</span><br><span class="line">  <span class="keyword">\draw_path_use:n</span>&#123;fill&#125;</span><br><span class="line">  <span class="keyword">\draw_scope_begin:</span></span><br><span class="line">  <span class="keyword">\draw_cap_round:</span></span><br><span class="line">  <span class="keyword">\draw_join_round:</span></span><br><span class="line">  <span class="keyword">\color_select:n</span>&#123;white&#125;</span><br><span class="line">  <span class="keyword">\draw_path_moveto:n</span>&#123;0.1cm,0.21cm&#125;</span><br><span class="line">  <span class="keyword">\draw_path_lineto:n</span>&#123;0.18cm,0.08cm&#125;</span><br><span class="line">  <span class="keyword">\draw_path_lineto:n</span>&#123;0.32cm,0.32cm&#125;</span><br><span class="line">  <span class="keyword">\draw_linewidth:n</span>&#123;1pt&#125;</span><br><span class="line">  <span class="keyword">\draw_path_use:n</span>&#123;stroke&#125;</span><br><span class="line">  <span class="keyword">\draw_scope_end:</span></span><br><span class="line">  <span class="keyword">\draw_end:</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">\cs_new:Npn</span> <span class="keyword">\__item_false_label:</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">\draw_begin:</span></span><br><span class="line">  <span class="keyword">\draw_baseline:n</span>&#123;0.5ex&#125;</span><br><span class="line">  <span class="keyword">\draw_linewidth:n</span>&#123;0.8pt&#125;</span><br><span class="line">  <span class="keyword">\draw_path_rectangle:nn</span>&#123;0,0&#125;&#123;0.4cm,0.4cm&#125;</span><br><span class="line">  <span class="keyword">\color_select:x</span>&#123;<span class="keyword">\_</span><span class="built_in">_</span>color<span class="built_in">_</span>tl&#125;</span><br><span class="line">  <span class="keyword">\draw_path_use:n</span>&#123;stroke&#125;</span><br><span class="line">  <span class="keyword">\draw_end:</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">\cs_new_protected:Npn</span> <span class="keyword">\__item_label:</span> </span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">\par</span></span><br><span class="line">  <span class="keyword">\int_compare:nF</span>&#123;<span class="keyword">\_</span><span class="built_in">_</span>item<span class="built_in">_</span>int = <span class="keyword">\c_zero_int</span>&#125;</span><br><span class="line">  &#123;</span><br><span class="line">	<span class="keyword">\__item_content:</span></span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">\int_incr:N</span> <span class="keyword">\_</span><span class="built_in">_</span>item<span class="built_in">_</span>int</span><br><span class="line">  <span class="keyword">\vcoffin_set:Nnx</span> <span class="keyword">\_</span><span class="built_in">_</span>label<span class="built_in">_</span>coffin &#123;1cm&#125;&#123;<span class="keyword">\_</span><span class="built_in">_</span>item<span class="built_in">_</span>tl&#125;</span><br><span class="line">  <span class="keyword">\vcoffin_set:Nnw</span> <span class="keyword">\_</span><span class="built_in">_</span>content<span class="built_in">_</span>coffin &#123;<span class="keyword">\textwidth</span> - <span class="keyword">\_</span><span class="built_in">_</span>parsep<span class="built_in">_</span>dim - 2cm&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">\cs_new_protected:Npn</span> <span class="keyword">\__item_content:</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">\vcoffin_set_end:</span></span><br><span class="line">  <span class="keyword">\coffin_join:NnnNnnnn</span> <span class="keyword">\_</span><span class="built_in">_</span>label<span class="built_in">_</span>coffin&#123;T&#125;&#123;r&#125;<span class="keyword">\_</span><span class="built_in">_</span>content<span class="built_in">_</span>coffin&#123;T&#125;&#123;l&#125;&#123;-10pt&#125;&#123;0pt&#125;</span><br><span class="line">  <span class="keyword">\coffin_typeset:Nnnnn</span> <span class="keyword">\_</span><span class="built_in">_</span>label<span class="built_in">_</span>coffin&#123;B&#125;&#123;l&#125;&#123;<span class="keyword">\_</span><span class="built_in">_</span>parsep<span class="built_in">_</span>dim&#125;&#123;<span class="keyword">\_</span><span class="built_in">_</span>vsep<span class="built_in">_</span>dim&#125;</span><br><span class="line">  <span class="keyword">\par</span> </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">\keys_define:nn</span>&#123;test&#125;</span><br><span class="line">&#123;</span><br><span class="line">  colorlist.clist<span class="built_in">_</span>set:N = <span class="keyword">\_</span><span class="built_in">_</span>color<span class="built_in">_</span>clist, <span class="comment">% 用于设置颜色列表</span></span><br><span class="line">  vsep.dim<span class="built_in">_</span>set:N = <span class="keyword">\_</span><span class="built_in">_</span>vsep<span class="built_in">_</span>dim, <span class="comment">% 控制每个条目的垂直间距</span></span><br><span class="line">  vsep.initial:n = 1pt, <span class="comment">% 设置初始值</span></span><br><span class="line">  parsep.dim<span class="built_in">_</span>set:N = <span class="keyword">\_</span><span class="built_in">_</span>parsep<span class="built_in">_</span>dim, <span class="comment">% 控制每个条目整体水平的偏移量</span></span><br><span class="line">  parsep.initial:n = <span class="keyword">\_</span><span class="built_in">_</span>parindent<span class="built_in">_</span>dim, <span class="comment">% 设置初始值</span></span><br><span class="line">  color.str<span class="built_in">_</span>set:N = <span class="keyword">\_</span><span class="built_in">_</span>color<span class="built_in">_</span>str, <span class="comment">% 用于设置单个颜色</span></span><br><span class="line">  color.initial:n = black <span class="comment">% 设置初始值</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">\NewDocumentEnvironment</span>&#123;test&#125;&#123;O&#123;&#125;&#125;</span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">\group_begin:</span> </span><br><span class="line">  <span class="keyword">\dim_set:Nn</span> <span class="keyword">\parindent</span>&#123;0pt&#125;</span><br><span class="line">  <span class="keyword">\int_zero:N</span> <span class="keyword">\_</span><span class="built_in">_</span>item<span class="built_in">_</span>int        </span><br><span class="line">  <span class="keyword">\keys_set:nn</span>&#123;test&#125;&#123;<span class="params">#1</span>&#125;</span><br><span class="line">  <span class="keyword">\seq_set_from_clist:NN</span> <span class="keyword">\_</span><span class="built_in">_</span>color<span class="built_in">_</span>seq <span class="keyword">\_</span><span class="built_in">_</span>color<span class="built_in">_</span>clist  </span><br><span class="line">  <span class="keyword">\clist_if_empty:NTF</span> <span class="keyword">\_</span><span class="built_in">_</span>color<span class="built_in">_</span>clist</span><br><span class="line">  &#123;</span><br><span class="line">	<span class="keyword">\tl_set:Nn</span><span class="keyword">\_</span><span class="built_in">_</span>color<span class="built_in">_</span>tl</span><br><span class="line">    &#123;<span class="keyword">\_</span><span class="built_in">_</span>color<span class="built_in">_</span>str&#125;</span><br><span class="line">  &#125;</span><br><span class="line">  &#123;</span><br><span class="line">	<span class="keyword">\tl_set:Nn</span><span class="keyword">\_</span><span class="built_in">_</span>color<span class="built_in">_</span>tl &#123;<span class="keyword">\clist_item:Nn</span><span class="keyword">\_</span><span class="built_in">_</span>color<span class="built_in">_</span>clist&#123;<span class="keyword">\_</span><span class="built_in">_</span>item<span class="built_in">_</span>int&#125;&#125;</span><br><span class="line">  &#125;     </span><br><span class="line">  <span class="keyword">\RenewDocumentCommand</span>&#123;<span class="keyword">\item</span>&#125;&#123;sO&#123;&#125;&#125;</span><br><span class="line">  &#123;           </span><br><span class="line">    <span class="keyword">\IfBooleanTF</span>&#123;<span class="params">##1</span>&#125;</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">\tl_gset:Nn</span> <span class="keyword">\_</span><span class="built_in">_</span>item<span class="built_in">_</span>tl</span><br><span class="line">      &#123;<span class="keyword">\__item_true_label:</span>&#125;</span><br><span class="line">	  &#125;</span><br><span class="line">	  &#123;</span><br><span class="line">	    <span class="keyword">\tl_gset:Nn</span> <span class="keyword">\_</span><span class="built_in">_</span>item<span class="built_in">_</span>tl</span><br><span class="line">	    &#123;</span><br><span class="line">		  <span class="keyword">\__item_false_label:</span></span><br><span class="line">	    &#125; </span><br><span class="line">	  &#125;	</span><br><span class="line">	<span class="keyword">\__item_label:</span>					</span><br><span class="line">  &#125;          </span><br><span class="line">&#125;</span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">\__item_content:</span></span><br><span class="line">  <span class="keyword">\group_end:</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">\ExplSyntaxOff</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">\begin</span>&#123;document&#125;</span><br><span class="line">我喜欢？</span><br><span class="line"><span class="keyword">\begin</span>&#123;test&#125;[colorlist =&#123; blue,red,yellow,cyan,black&#125;,]</span><br><span class="line">	<span class="keyword">\item</span> 抽烟</span><br><span class="line">	<span class="keyword">\item</span>* 喝酒</span><br><span class="line">	<span class="keyword">\item</span>  蹦迪</span><br><span class="line">	<span class="keyword">\item</span>  赌博</span><br><span class="line">	<span class="keyword">\item</span>* 美女</span><br><span class="line"><span class="keyword">\end</span>&#123;test&#125;</span><br><span class="line">   </span><br><span class="line"><span class="keyword">\end</span>&#123;document&#125;</span><br></pre></td></tr></table></figure>

<h2 id="测试"><a href="#测试" class="headerlink" title="测试"></a>测试</h2><ul>
<li>测试一 <figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">我喜欢？</span><br><span class="line"><span class="keyword">\begin</span>&#123;test&#125;[colorlist =&#123; blue,red,yellow,cyan,black&#125;,vsep = 10pt]</span><br><span class="line">	<span class="keyword">\item</span> 抽烟</span><br><span class="line">	<span class="keyword">\item</span>* 喝酒</span><br><span class="line">	<span class="keyword">\item</span>  蹦迪</span><br><span class="line">	<span class="keyword">\item</span>  赌博</span><br><span class="line">	<span class="keyword">\item</span>* 美女</span><br><span class="line"><span class="keyword">\end</span>&#123;test&#125;</span><br></pre></td></tr></table></figure></li>
</ul>
<p><img src="https://ljguo-1308058910.cos.ap-nanjing.myqcloud.com//img/LaTeX_choice_box3.png"></p>
<ul>
<li>测试二</li>
</ul>
<figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">我喜欢？</span><br><span class="line"><span class="keyword">\begin</span>&#123;test&#125;[color = blue]</span><br><span class="line">	<span class="keyword">\item</span> 吃饭</span><br><span class="line">	<span class="keyword">\item</span> 睡觉</span><br><span class="line">	<span class="keyword">\item</span>* 玩手机</span><br><span class="line">	<span class="keyword">\item</span>* <span class="keyword">\LaTeX</span> </span><br><span class="line">	<span class="keyword">\item</span>* 编程</span><br><span class="line">	<span class="keyword">\item</span>* 算法</span><br><span class="line"><span class="keyword">\end</span>&#123;test&#125;</span><br></pre></td></tr></table></figure>

<p><img src="https://ljguo-1308058910.cos.ap-nanjing.myqcloud.com//img/LaTeX_choice_box4.png"></p>
<hr>
<p>如果懒得复制源码，可以到我的 <a target="_blank" rel="noopener" href="https://github.com/ljguo1020/TeX/tree/main/choice-box">GitHub</a> 下载</p>
<p>下次再见~</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://example.com/1970/01/01/LaTeX-show-answer/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="ljguo">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="LJGUO">
      <meta itemprop="description" content="学习交流">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | LJGUO">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/1970/01/01/LaTeX-show-answer/" class="post-title-link" itemprop="url">实现一个控制答案显示的功能</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：1970-01-01 08:00:00" itemprop="dateCreated datePublished" datetime="1970-01-01T08:00:00+08:00">1970-01-01</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2022-11-11 22:46:22" itemprop="dateModified" datetime="2022-11-11T22:46:22+08:00">2022-11-11</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/LaTeX/" itemprop="url" rel="index"><span itemprop="name">LaTeX</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>有很多老师想要实现一个<strong>师生两版</strong>的效果。这是一个什么样的效果呢，其实就是教师版的需要显示答案、提示、标注、等等，学生版则不需要。有些老师可能会选择<strong>注释法</strong>，也即是先把答案等注释掉，生成学生版，然后再来取消注释，生成教师版，但这样未免太麻烦了，其实这个很简单，我们可以使用通过设置一个布尔值来控制答案显示与否</p>
<h2 id="实现细节"><a href="#实现细节" class="headerlink" title="实现细节"></a>实现细节</h2><ul>
<li>先定义两个变量</li>
</ul>
<figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">\tl_clear_new:N</span> <span class="keyword">\_</span><span class="built_in">_</span>answer<span class="built_in">_</span>tl <span class="comment">% 用于保存答案</span></span><br><span class="line"><span class="keyword">\bool_new:N</span> <span class="keyword">\_</span><span class="built_in">_</span>answer<span class="built_in">_</span>bool <span class="comment">% bool变量，用于控制答案显示与否</span></span><br></pre></td></tr></table></figure>

<ul>
<li>声明两个环境</li>
</ul>
<figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">\NewDocumentEnvironment</span>&#123;exercise&#125;&#123;+b&#125;</span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">\noindent</span><span class="keyword">\textbf</span>&#123;<span class="keyword">\textcolor</span>&#123;magenta&#125;&#123;题目：&#125;&#125;<span class="keyword">\par</span> </span><br><span class="line"> <span class="params">#1</span></span><br><span class="line">&#125;&#123;&#125;</span><br><span class="line"><span class="keyword">\NewDocumentEnvironment</span>&#123;answer&#125;&#123;+b&#125;</span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">\tl_set:Nn</span> <span class="keyword">\_</span><span class="built_in">_</span>answer<span class="built_in">_</span>tl</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">\noindent</span><span class="keyword">\textbf</span>&#123;<span class="keyword">\textcolor</span>&#123;blue&#125;&#123;答案：&#125;&#125;<span class="keyword">\par</span></span><br><span class="line">    <span class="params">#1</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">\par</span> </span><br><span class="line">  <span class="keyword">\bool_if:NT</span><span class="keyword">\_</span><span class="built_in">_</span>answer<span class="built_in">_</span>bool&#123;<span class="keyword">\tl_use:N</span> <span class="keyword">\_</span><span class="built_in">_</span>answer<span class="built_in">_</span>tl&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p> 其中<code>exercise</code> <code>answer</code> 两个环境分别用于输出题目和答案，在上面，可以发现这样一行代码</p>
 <figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">\tl_set:Nn</span> <span class="keyword">\_</span><span class="built_in">_</span>answer<span class="built_in">_</span>tl</span><br><span class="line"> &#123;</span><br><span class="line">   <span class="keyword">\noindent</span><span class="keyword">\textbf</span>&#123;<span class="keyword">\textcolor</span>&#123;blue&#125;&#123;答案：&#125;&#125;<span class="keyword">\par</span></span><br><span class="line">   <span class="params">#1</span></span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure>

<p>这是将答案的内容写进 <code>\__answer_tl</code> 这个变量里面，而</p>
<figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">\bool_if:NT</span><span class="keyword">\_</span><span class="built_in">_</span>answer<span class="built_in">_</span>bool&#123;<span class="keyword">\tl_use:N</span> <span class="keyword">\_</span><span class="built_in">_</span>answer<span class="built_in">_</span>tl&#125;</span><br></pre></td></tr></table></figure>

<p>这行代码中 <code>\bool_if:NT</code> 函数用于判断 <code>\__answer_bool</code> 这个 bool 变量的真假，如果为真则执行</p>
<figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">\tl_use:N</span> <span class="keyword">\_</span><span class="built_in">_</span>answer<span class="built_in">_</span>tl</span><br></pre></td></tr></table></figure>

<p>上面这行代码的作用是使 <code>\__answer_tl</code> 变量的值显示出来，也就是把我们保存的答案显示出来</p>
<p>可见这里决定答案显示与否的就是这个 bool 变量的真假了，我们通过</p>
<figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">\bool_set_true:N</span> <span class="keyword">\_</span><span class="built_in">_</span>answer<span class="built_in">_</span>bool</span><br><span class="line"><span class="keyword">\bool_set_false:N</span> <span class="keyword">\_</span><span class="built_in">_</span>answer<span class="built_in">_</span>bool</span><br></pre></td></tr></table></figure>

<p>可以将该 bool 变量的设置为<strong>逻辑真</strong>和<strong>逻辑假</strong>，我们来看一下完整源码</p>
<h4 id="完整源码1"><a href="#完整源码1" class="headerlink" title="完整源码1"></a>完整源码1</h4><figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">\documentclass</span>&#123;ctexart&#125;</span><br><span class="line"><span class="keyword">\usepackage</span>&#123;xcolor&#125;</span><br><span class="line"><span class="keyword">\ExplSyntaxOn</span></span><br><span class="line"><span class="keyword">\tl_clear_new:N</span> <span class="keyword">\_</span><span class="built_in">_</span>answer<span class="built_in">_</span>tl <span class="comment">% 用于保存答案</span></span><br><span class="line"><span class="keyword">\bool_new:N</span> <span class="keyword">\_</span><span class="built_in">_</span>answer<span class="built_in">_</span>bool <span class="comment">% bool变量，用于控制答案显示与否</span></span><br><span class="line"><span class="keyword">\bool_set_true:N</span> <span class="keyword">\_</span><span class="built_in">_</span>answer<span class="built_in">_</span>bool <span class="comment">% 将 \__answer_bool 设置为真，则显示答案，如果注释掉，则不显示</span></span><br><span class="line"><span class="keyword">\NewDocumentEnvironment</span>&#123;exercise&#125;&#123;+b&#125;</span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">\noindent</span><span class="keyword">\textbf</span>&#123;<span class="keyword">\textcolor</span>&#123;magenta&#125;&#123;题目：&#125;&#125;<span class="keyword">\par</span> </span><br><span class="line"> <span class="params">#1</span></span><br><span class="line">&#125;&#123;&#125;</span><br><span class="line"><span class="keyword">\NewDocumentEnvironment</span>&#123;answer&#125;&#123;+b&#125;</span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">\tl_set:Nn</span> <span class="keyword">\_</span><span class="built_in">_</span>answer<span class="built_in">_</span>tl</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">\noindent</span><span class="keyword">\textbf</span>&#123;<span class="keyword">\textcolor</span>&#123;blue&#125;&#123;答案：&#125;&#125;<span class="keyword">\par</span></span><br><span class="line">    <span class="params">#1</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">\par</span> </span><br><span class="line">  <span class="keyword">\bool_if:NT</span><span class="keyword">\_</span><span class="built_in">_</span>answer<span class="built_in">_</span>bool&#123;<span class="keyword">\tl_use:N</span> <span class="keyword">\_</span><span class="built_in">_</span>answer<span class="built_in">_</span>tl&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">\ExplSyntaxOff</span></span><br><span class="line"><span class="keyword">\begin</span>&#123;document&#125;</span><br><span class="line"><span class="keyword">\begin</span>&#123;exercise&#125;</span><br><span class="line">这是题目.....</span><br><span class="line"><span class="keyword">\begin</span>&#123;answer&#125;</span><br><span class="line">这是答案...</span><br><span class="line"><span class="keyword">\end</span>&#123;answer&#125;</span><br><span class="line"><span class="keyword">\end</span>&#123;exercise&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">\begin</span>&#123;exercise&#125;</span><br><span class="line">  这是题目.....</span><br><span class="line"><span class="keyword">\begin</span>&#123;answer&#125;</span><br><span class="line">  这是答案...</span><br><span class="line"><span class="keyword">\end</span>&#123;answer&#125;</span><br><span class="line"><span class="keyword">\end</span>&#123;exercise&#125;</span><br><span class="line"><span class="keyword">\end</span>&#123;document&#125;</span><br></pre></td></tr></table></figure>

<h4 id="结果"><a href="#结果" class="headerlink" title="结果"></a>结果</h4><p><img src="https://ljguo-1308058910.cos.ap-nanjing.myqcloud.com//img/LaTeX_show_answer1.png"></p>
<p>如果将第六行代码注释则不会显示答案</p>
<h4 id="写进cls-推荐"><a href="#写进cls-推荐" class="headerlink" title="写进cls(推荐)"></a>写进cls(推荐)</h4><p>这里我需要新建一个文件，命名为 <code>mycls.cls</code> ,内容如下</p>
<figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">\NeedsTeXFormat</span>&#123;LaTeX2e&#125;</span><br><span class="line"><span class="keyword">\LoadClass</span>&#123;ctexart&#125;</span><br><span class="line"><span class="keyword">\ProvidesClass</span>&#123;mycls&#125;</span><br><span class="line"><span class="keyword">\RequirePackage</span>&#123;xcolor&#125;</span><br><span class="line"><span class="keyword">\ExplSyntaxOn</span></span><br><span class="line"><span class="keyword">\tl_clear_new:N</span> <span class="keyword">\_</span><span class="built_in">_</span>answer<span class="built_in">_</span>tl</span><br><span class="line"><span class="keyword">\bool_new:N</span> <span class="keyword">\_</span><span class="built_in">_</span>answer<span class="built_in">_</span>bool</span><br><span class="line"><span class="keyword">\keys_define:nn</span>&#123;answer&#125;</span><br><span class="line">&#123;</span><br><span class="line">  show-answer.code:n = &#123;<span class="keyword">\bool_set_true:N</span> <span class="keyword">\_</span><span class="built_in">_</span>answer<span class="built_in">_</span>bool&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">\ProcessKeysOptions</span>&#123;answer&#125;</span><br><span class="line"><span class="keyword">\NewDocumentEnvironment</span>&#123;exercise&#125;&#123;+b&#125;</span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">\noindent</span><span class="keyword">\textbf</span>&#123;<span class="keyword">\textcolor</span>&#123;magenta&#125;&#123;题目：&#125;&#125;<span class="keyword">\par</span> </span><br><span class="line"> <span class="params">#1</span></span><br><span class="line">&#125;&#123;&#125;</span><br><span class="line"><span class="keyword">\NewDocumentEnvironment</span>&#123;answer&#125;&#123;+b&#125;</span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">\tl_set:Nn</span> <span class="keyword">\_</span><span class="built_in">_</span>answer<span class="built_in">_</span>tl</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">\noindent</span><span class="keyword">\textbf</span>&#123;<span class="keyword">\textcolor</span>&#123;blue&#125;&#123;答案：&#125;&#125;<span class="keyword">\par</span></span><br><span class="line">    <span class="params">#1</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">\par</span> </span><br><span class="line">  <span class="keyword">\bool_if:NT</span><span class="keyword">\_</span><span class="built_in">_</span>answer<span class="built_in">_</span>bool&#123;<span class="keyword">\tl_use:N</span> <span class="keyword">\_</span><span class="built_in">_</span>answer<span class="built_in">_</span>tl&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">\ExplSyntaxOff</span></span><br><span class="line"><span class="keyword">\endinput</span></span><br></pre></td></tr></table></figure>

<p>只对部分代码进行解读，其它的参看隔壁</p>
<figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">\keys_define:nn</span>&#123;answer&#125;</span><br><span class="line">&#123;</span><br><span class="line">  show-answer.code:n = &#123;<span class="keyword">\bool_set_true:N</span> <span class="keyword">\_</span><span class="built_in">_</span>answer<span class="built_in">_</span>bool&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>这里使用 <code>l3keys</code> 包提供的键值设置，定义了一个 <code>show-answer</code> 键，他的内容是将 bool 变量设置为逻辑真</p>
<figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">\ProcessKeysOptions</span>&#123;answer&#125;</span><br></pre></td></tr></table></figure>

<p>这里使用 <code>l3keys2e</code> 包提供的 <code>\ProcessKeysOptions</code> 命令，它可以将所接受到的模块内的键值设置传递给我们的模板 <code>class</code> ,这两个包均已内嵌在 LaTeX 内核，无需显示加载，这样我们只需在源文件中</p>
<figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">\documentclass</span>[show-answer]&#123;mycls&#125;</span><br><span class="line"><span class="comment">%如果加了show-answer可选项，则显示答案，反之则不显示</span></span><br><span class="line"><span class="keyword">\begin</span>&#123;document&#125;</span><br><span class="line"><span class="keyword">\begin</span>&#123;exercise&#125;</span><br><span class="line">这是题目.....</span><br><span class="line"><span class="keyword">\begin</span>&#123;answer&#125;</span><br><span class="line">这是答案...</span><br><span class="line"><span class="keyword">\end</span>&#123;answer&#125;</span><br><span class="line"><span class="keyword">\end</span>&#123;exercise&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">\begin</span>&#123;exercise&#125;</span><br><span class="line">  这是题目.....</span><br><span class="line"><span class="keyword">\begin</span>&#123;answer&#125;</span><br><span class="line">  这是答案...</span><br><span class="line"><span class="keyword">\end</span>&#123;answer&#125;</span><br><span class="line"><span class="keyword">\end</span>&#123;exercise&#125;</span><br><span class="line"><span class="keyword">\end</span>&#123;document&#125;</span><br></pre></td></tr></table></figure>

<p>这里输出和前面一样</p>
<p>至此，大功告成，现在是 4:10 该睡觉了~</p>
<p>如果有问题，欢迎下方评论~</p>
<p>如果本文对您有帮助，您可以请我喝杯奶茶~</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://example.com/1970/01/01/LaTeX-vscode/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="ljguo">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="LJGUO">
      <meta itemprop="description" content="学习交流">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | LJGUO">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/1970/01/01/LaTeX-vscode/" class="post-title-link" itemprop="url">使用 Vscode 配置 LaTeX</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：1970-01-01 08:00:00" itemprop="dateCreated datePublished" datetime="1970-01-01T08:00:00+08:00">1970-01-01</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2022-11-11 22:40:42" itemprop="dateModified" datetime="2022-11-11T22:40:42+08:00">2022-11-11</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/LaTeX/" itemprop="url" rel="index"><span itemprop="name">LaTeX</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <blockquote>
<p>Vscode 是一款杰出的代码编辑器，不论从代码高亮，自动补全上来讲，都是相当不错的，本文将要介绍在 Vscode 中配置 LaTeX</p>
</blockquote>
<blockquote>
<p>本文默认用户已经安装好了 texlive</p>
</blockquote>
<h2 id="下载-vscode"><a href="#下载-vscode" class="headerlink" title="下载 vscode"></a>下载 vscode</h2><p>直接到官网下载最新版的 vscode ，当然官网需要科学上网，不然下载很慢，当然也有其他的法子，自行百度吧</p>
<p>我们需要记住 vscode 的安装路径，后面需要用到</p>
<h3 id="安装插件"><a href="#安装插件" class="headerlink" title="安装插件"></a>安装插件</h3><ul>
<li>Chinese  , 用于汉化界面</li>
<li>LaTeX Workshop , 必备插件</li>
</ul>
<p>安装好插件我们重启一下 vscode ，点击左下角齿轮，打开设置，并打开配置文件 <strong>settings.json</strong> ,按下图操作</p>
<p><img src="https://ljguo-1308058910.cos.ap-nanjing.myqcloud.com//img/1.png"></p>
<p><img src="https://ljguo-1308058910.cos.ap-nanjing.myqcloud.com//img/2.png"></p>
<p>这样就打开了配置文件，接下来我们来修改配置文件，将下面代码粘贴到里面，如果你是新安装的用户，直接用下面的代码替换你原来的就行了</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;latex-workshop.latex.autoBuild.run&quot;</span><span class="punctuation">:</span> <span class="string">&quot;never&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;latex-workshop.showContextMenu&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">true</span></span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;latex-workshop.intellisense.package.enabled&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">true</span></span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;latex-workshop.message.error.show&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">false</span></span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;latex-workshop.message.warning.show&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">false</span></span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;latex-workshop.latex.tools&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">        <span class="punctuation">&#123;</span></span><br><span class="line">            <span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;xelatex&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;command&quot;</span><span class="punctuation">:</span> <span class="string">&quot;xelatex&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;args&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">                <span class="string">&quot;-synctex=1&quot;</span><span class="punctuation">,</span></span><br><span class="line">                <span class="string">&quot;-interaction=nonstopmode&quot;</span><span class="punctuation">,</span></span><br><span class="line">                <span class="string">&quot;-file-line-error&quot;</span><span class="punctuation">,</span></span><br><span class="line">                <span class="string">&quot;%DOCFILE%&quot;</span></span><br><span class="line">            <span class="punctuation">]</span></span><br><span class="line">        <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="punctuation">&#123;</span></span><br><span class="line">            <span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;pdflatex&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;command&quot;</span><span class="punctuation">:</span> <span class="string">&quot;pdflatex&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;args&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">                <span class="string">&quot;-synctex=1&quot;</span><span class="punctuation">,</span></span><br><span class="line">                <span class="string">&quot;-interaction=nonstopmode&quot;</span><span class="punctuation">,</span></span><br><span class="line">                <span class="string">&quot;-file-line-error&quot;</span><span class="punctuation">,</span></span><br><span class="line">                <span class="string">&quot;%DOCFILE%&quot;</span></span><br><span class="line">            <span class="punctuation">]</span></span><br><span class="line">        <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="punctuation">&#123;</span></span><br><span class="line">            <span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;latexmk&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;command&quot;</span><span class="punctuation">:</span> <span class="string">&quot;latexmk&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;args&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">                <span class="string">&quot;-synctex=1&quot;</span><span class="punctuation">,</span></span><br><span class="line">                <span class="string">&quot;-interaction=nonstopmode&quot;</span><span class="punctuation">,</span></span><br><span class="line">                <span class="string">&quot;-file-line-error&quot;</span><span class="punctuation">,</span></span><br><span class="line">                <span class="string">&quot;-pdf&quot;</span><span class="punctuation">,</span></span><br><span class="line">                <span class="string">&quot;-outdir=%OUTDIR%&quot;</span><span class="punctuation">,</span></span><br><span class="line">                <span class="string">&quot;%DOCFILE%&quot;</span></span><br><span class="line">            <span class="punctuation">]</span></span><br><span class="line">        <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="punctuation">&#123;</span></span><br><span class="line">            <span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;bibtex&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;command&quot;</span><span class="punctuation">:</span> <span class="string">&quot;bibtex&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;args&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">                <span class="string">&quot;%DOCFILE%&quot;</span></span><br><span class="line">            <span class="punctuation">]</span></span><br><span class="line">        <span class="punctuation">&#125;</span></span><br><span class="line">    <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;latex-workshop.latex.recipes&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">        <span class="punctuation">&#123;</span></span><br><span class="line">            <span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;XeLaTeX&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;tools&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">                <span class="string">&quot;xelatex&quot;</span></span><br><span class="line">            <span class="punctuation">]</span></span><br><span class="line">        <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="punctuation">&#123;</span></span><br><span class="line">            <span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;PDFLaTeX&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;tools&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">                <span class="string">&quot;pdflatex&quot;</span></span><br><span class="line">            <span class="punctuation">]</span></span><br><span class="line">        <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="punctuation">&#123;</span></span><br><span class="line">            <span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;BibTeX&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;tools&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">                <span class="string">&quot;bibtex&quot;</span></span><br><span class="line">            <span class="punctuation">]</span></span><br><span class="line">        <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="punctuation">&#123;</span></span><br><span class="line">            <span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;LaTeXmk&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;tools&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">                <span class="string">&quot;latexmk&quot;</span></span><br><span class="line">            <span class="punctuation">]</span></span><br><span class="line">        <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="punctuation">&#123;</span></span><br><span class="line">            <span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;xelatex -&gt; bibtex -&gt; xelatex*2&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;tools&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">                <span class="string">&quot;xelatex&quot;</span><span class="punctuation">,</span></span><br><span class="line">                <span class="string">&quot;bibtex&quot;</span><span class="punctuation">,</span></span><br><span class="line">                <span class="string">&quot;xelatex&quot;</span><span class="punctuation">,</span></span><br><span class="line">                <span class="string">&quot;xelatex&quot;</span></span><br><span class="line">            <span class="punctuation">]</span></span><br><span class="line">        <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="punctuation">&#123;</span></span><br><span class="line">            <span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;pdflatex -&gt; bibtex -&gt; pdflatex*2&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;tools&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">                <span class="string">&quot;pdflatex&quot;</span><span class="punctuation">,</span></span><br><span class="line">                <span class="string">&quot;bibtex&quot;</span><span class="punctuation">,</span></span><br><span class="line">                <span class="string">&quot;pdflatex&quot;</span><span class="punctuation">,</span></span><br><span class="line">                <span class="string">&quot;pdflatex&quot;</span></span><br><span class="line">            <span class="punctuation">]</span></span><br><span class="line">        <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;latex-workshop.latex.clean.fileTypes&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">        <span class="string">&quot;*.aux&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="string">&quot;*.bbl&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="string">&quot;*.blg&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="string">&quot;*.idx&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="string">&quot;*.ind&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="string">&quot;*.lof&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="string">&quot;*.lot&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="string">&quot;*.out&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="string">&quot;*.toc&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="string">&quot;*.acn&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="string">&quot;*.acr&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="string">&quot;*.alg&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="string">&quot;*.glg&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="string">&quot;*.glo&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="string">&quot;*.gls&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="string">&quot;*.ist&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="string">&quot;*.fls&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="string">&quot;*.log&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="string">&quot;*.fdb_latexmk&quot;</span></span><br><span class="line">    <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;latex-workshop.latex.autoClean.run&quot;</span><span class="punctuation">:</span> <span class="string">&quot;onFailed&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;latex-workshop.latex.recipe.default&quot;</span><span class="punctuation">:</span> <span class="string">&quot;lastUsed&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;latex-workshop.view.pdf.internal.synctex.keybinding&quot;</span><span class="punctuation">:</span> <span class="string">&quot;double-click&quot;</span><span class="punctuation">,</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>

<p>这段代码已经足够您使用 vscode 来编译 LaTeX 了，下面我们讲一下如何使用外部阅读器来查看编译好的 pdf 文件</p>
<h2 id="安装SumatraPdf"><a href="#安装SumatraPdf" class="headerlink" title="安装SumatraPdf"></a>安装SumatraPdf</h2><p>这里推荐 SumatraPdf 这个软件，到官网下载安装即可</p>
<p>同样我们需要记住 SumatraPdf 的安装路径，后面需要用到</p>
<p>随后将下面代码放到 <strong>settings.json</strong> 这份配置文件中，注意放的位置在最后一个花括号前面</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">&quot;latex-workshop.view.pdf.viewer&quot;</span><span class="punctuation">:</span> <span class="string">&quot;external&quot;</span><span class="punctuation">,</span></span><br><span class="line"><span class="attr">&quot;latex-workshop.view.pdf.external.viewer.command&quot;</span><span class="punctuation">:</span></span><br><span class="line">       <span class="string">&quot;D:/Code/SumatraPDF/SumatraPDF.exe&quot;</span><span class="punctuation">,</span>  <span class="comment">//注意修改路径</span></span><br><span class="line"><span class="attr">&quot;latex-workshop.view.pdf.external.viewer.args&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">        <span class="string">&quot;%PDF%&quot;</span></span><br><span class="line">    <span class="punctuation">]</span><span class="punctuation">,</span></span><br></pre></td></tr></table></figure>

<p>上面代码中已经标明需要修改路径，这个路径正是我们安装的 SumatraPdf 的路径</p>
<p>这样保存后即可通过外部阅读器来查看pdf了</p>
<h2 id="配置反向搜索"><a href="#配置反向搜索" class="headerlink" title="配置反向搜索"></a>配置反向搜索</h2><p>反向搜索有利于我们快速定位到文档对应的源码位置，我们需要将下面代码加入到 <strong>settings.json</strong> 里面，同样也是最后一个花括号前面</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">&quot;latex-workshop.view.pdf.external.synctex.command&quot;</span><span class="punctuation">:</span></span><br><span class="line">    <span class="string">&quot;D:/Code/SumatraPDF/SumatraPDF.exe&quot;</span><span class="punctuation">,</span>  <span class="comment">//注意修改路径</span></span><br><span class="line">    <span class="attr">&quot;latex-workshop.view.pdf.external.synctex.args&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">    <span class="string">&quot;-forward-search&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="string">&quot;%TEX%&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="string">&quot;%LINE%&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="string">&quot;%PDF%&quot;</span><span class="punctuation">,</span></span><br><span class="line"><span class="punctuation">]</span><span class="punctuation">,</span></span><br></pre></td></tr></table></figure>

<p>然后我们还需要在 SumatraPdf 软件中做一些配置，通过设置打开高级选项，会弹出一个配置文件，我们只需在配置文件最后加上如下代码</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">InverseSearchCmdLine = <span class="string">&quot;D:\Code\VS code\Microsoft VS Code\Code.exe&quot;</span> <span class="string">&quot;D:\Code\VS code\Microsoft VS Code\resources\app\out\cli.js&quot;</span>  --ms-enable-electron-run-as-node -r -g <span class="string">&quot;%f:%l&quot;</span></span><br><span class="line">EnableTeXEnhancements = <span class="literal"><span class="keyword">true</span></span></span><br></pre></td></tr></table></figure>

<p>注意上面代码中 <code>D:\Code\VS code</code> 是我的 vscode 的安装路径，请换成你的，然后就可以通过在 pdf 文档中双击跳转到 vscode 源码部分了</p>
<p>以上就是在 vscode 中配置 LaTeX 的全部过程，有时间我会将其写得更加详细一点，如果有问题欢迎评论区留言</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://example.com/1970/01/01/LaTeX3-TikZ/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="ljguo">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="LJGUO">
      <meta itemprop="description" content="学习交流">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | LJGUO">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/1970/01/01/LaTeX3-TikZ/" class="post-title-link" itemprop="url">LaTeX3 和 TikZ 结合绘图</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：1970-01-01 08:00:00" itemprop="dateCreated datePublished" datetime="1970-01-01T08:00:00+08:00">1970-01-01</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2022-11-11 22:39:59" itemprop="dateModified" datetime="2022-11-11T22:39:59+08:00">2022-11-11</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/LaTeX/" itemprop="url" rel="index"><span itemprop="name">LaTeX</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>这是LaTeX3的使用样例</p>
<hr>
<h2 id="定义颜色"><a href="#定义颜色" class="headerlink" title="定义颜色"></a>定义颜色</h2><p>colors.tex</p>
<figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">\definecolor</span>&#123;1&#125;&#123;RGB&#125;&#123;255,255,255&#125;</span><br><span class="line"><span class="keyword">\definecolor</span>&#123;2&#125;&#123;RGB&#125;&#123;255,20,147&#125;</span><br><span class="line"><span class="keyword">\definecolor</span>&#123;3&#125;&#123;RGB&#125;&#123;0,255,255&#125;</span><br><span class="line"><span class="keyword">\definecolor</span>&#123;4&#125;&#123;RGB&#125;&#123;255,20,147&#125;</span><br><span class="line"><span class="keyword">\definecolor</span>&#123;5&#125;&#123;RGB&#125;&#123;225,0,0&#125;</span><br><span class="line"><span class="keyword">\definecolor</span>&#123;6&#125;&#123;RGB&#125;&#123;225,255,0&#125;</span><br><span class="line"><span class="keyword">\definecolor</span>&#123;7&#125;&#123;RGB&#125;&#123;47,79,79&#125;</span><br><span class="line"><span class="keyword">\definecolor</span>&#123;8&#125;&#123;RGB&#125;&#123;25,25,112&#125;</span><br><span class="line"><span class="keyword">\definecolor</span>&#123;9&#125;&#123;RGB&#125;&#123;0,200,0&#125;</span><br><span class="line"><span class="keyword">\definecolor</span>&#123;10&#125;&#123;RGB&#125;&#123;124,252,0&#125;</span><br><span class="line"><span class="keyword">\definecolor</span>&#123;11&#125;&#123;RGB&#125;&#123;139,69,19&#125;</span><br><span class="line"><span class="keyword">\definecolor</span>&#123;12&#125;&#123;RGB&#125;&#123;250,128,114&#125;</span><br><span class="line"><span class="keyword">\definecolor</span>&#123;13&#125;&#123;RGB&#125;&#123;255,69,0&#125;</span><br><span class="line"><span class="keyword">\definecolor</span>&#123;14&#125;&#123;RGB&#125;&#123;153,50,204&#125;</span><br><span class="line"><span class="keyword">\definecolor</span>&#123;15&#125;&#123;RGB&#125;&#123;139,121,94&#125;</span><br><span class="line"><span class="keyword">\definecolor</span>&#123;16&#125;&#123;RGB&#125;&#123;205,193,197&#125;</span><br><span class="line"><span class="keyword">\definecolor</span>&#123;17&#125;&#123;RGB&#125;&#123;205,16,118&#125;</span><br><span class="line"><span class="keyword">\definecolor</span>&#123;18&#125;&#123;RGB&#125;&#123;238,154,0&#125;</span><br><span class="line"><span class="keyword">\definecolor</span>&#123;19&#125;&#123;RGB&#125;&#123;205,133,63&#125;</span><br><span class="line"><span class="keyword">\definecolor</span>&#123;20&#125;&#123;RGB&#125;&#123;139,0,139&#125;</span><br></pre></td></tr></table></figure>
<h2 id="主文件"><a href="#主文件" class="headerlink" title="主文件"></a>主文件</h2><p>main.tex</p>
<figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">\documentclass</span>[margin=5cm]&#123;standalone&#125;</span><br><span class="line"><span class="keyword">\usepackage</span>&#123;tikz&#125;</span><br><span class="line"><span class="keyword">\pagecolor</span>&#123;black&#125;</span><br><span class="line"><span class="keyword">\input</span>&#123;colors.tex&#125;</span><br><span class="line"><span class="keyword">\ExplSyntaxOn</span></span><br><span class="line"><span class="keyword">\NewDocumentCommand</span>&#123;<span class="keyword">\helix</span>&#125;&#123; m m m&#125;</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">\draw</span>[line~width=2pt,<span class="params">#2</span>] <span class="params">#1</span>+(0 <span class="keyword">\c_colon_str</span> <span class="params">#3</span>)--+(60 <span class="keyword">\c_colon_str</span> <span class="params">#3</span>)--+(120 <span class="keyword">\c_colon_str</span> <span class="params">#3</span>)--+(180 <span class="keyword">\c_colon_str</span> <span class="params">#3</span>)--+(240 <span class="keyword">\c_colon_str</span> <span class="params">#3</span>)--+(300 <span class="keyword">\c_colon_str</span> <span class="params">#3</span>)--cycle;</span><br><span class="line">    <span class="keyword">\draw</span>[line~width=2pt,<span class="params">#2</span>] <span class="params">#1</span>+(10 <span class="keyword">\c_colon_str</span> <span class="params">#3</span>)--+(70 <span class="keyword">\c_colon_str</span> <span class="params">#3</span>)--+(130 <span class="keyword">\c_colon_str</span> <span class="params">#3</span>)--+(190 <span class="keyword">\c_colon_str</span> <span class="params">#3</span>)--+(250 <span class="keyword">\c_colon_str</span> <span class="params">#3</span>)--+(310 <span class="keyword">\c_colon_str</span> <span class="params">#3</span>)--cycle;</span><br><span class="line">    <span class="keyword">\draw</span>[line~width=2pt,<span class="params">#2</span>] <span class="params">#1</span>+(20 <span class="keyword">\c_colon_str</span> <span class="params">#3</span>)--+(80 <span class="keyword">\c_colon_str</span> <span class="params">#3</span>)--+(140 <span class="keyword">\c_colon_str</span> <span class="params">#3</span>)--+(200 <span class="keyword">\c_colon_str</span> <span class="params">#3</span>)--+(260 <span class="keyword">\c_colon_str</span> <span class="params">#3</span>)--+(320 <span class="keyword">\c_colon_str</span> <span class="params">#3</span>)--cycle;</span><br><span class="line">    <span class="keyword">\draw</span>[line~width=2pt,<span class="params">#2</span>] <span class="params">#1</span>+(30 <span class="keyword">\c_colon_str</span> <span class="params">#3</span>)--+(90 <span class="keyword">\c_colon_str</span> <span class="params">#3</span>)--+(150 <span class="keyword">\c_colon_str</span> <span class="params">#3</span>)--+(210 <span class="keyword">\c_colon_str</span> <span class="params">#3</span>)--+(270 <span class="keyword">\c_colon_str</span> <span class="params">#3</span>)--+(330 <span class="keyword">\c_colon_str</span> <span class="params">#3</span>)--cycle;   </span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">\ExplSyntaxOff</span></span><br><span class="line"><span class="keyword">\begin</span>&#123;document&#125;</span><br><span class="line"><span class="keyword">\ExplSyntaxOn</span></span><br><span class="line"><span class="keyword">\begin</span>&#123;tikzpicture&#125;[x=0.1cm,y=0.1cm]  </span><br><span class="line">    <span class="keyword">\int_step_variable:nnnNn</span>&#123;0&#125;&#123;10&#125;&#123;1080&#125; <span class="keyword">\i</span> </span><br><span class="line">        &#123;   </span><br><span class="line">            <span class="keyword">\helix</span>&#123;(<span class="keyword">\i</span> <span class="keyword">\c_colon_str</span> 2+1*<span class="keyword">\i</span>)&#125;&#123;<span class="keyword">\int_rand:nn</span>&#123;1&#125;&#123;20&#125;&#125;&#123;0.15*<span class="keyword">\i</span>&#125;        </span><br><span class="line">        &#125;</span><br><span class="line"><span class="keyword">\end</span>&#123;tikzpicture&#125;</span><br><span class="line"><span class="keyword">\ExplSyntaxOff</span></span><br><span class="line"><span class="keyword">\end</span>&#123;document&#125;</span><br></pre></td></tr></table></figure>
<p>输出<br><img src="https://pic4.zhimg.com/80/v2-13e03941cfa2da229449c2128c569c25.jpg" alt="Image"><br>将函数解析式稍加修改</p>
<figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">\documentclass</span>[margin=10cm]&#123;standalone&#125;</span><br><span class="line"><span class="keyword">\usepackage</span>&#123;tikz&#125;</span><br><span class="line"><span class="keyword">\pagecolor</span>&#123;black&#125;</span><br><span class="line"><span class="keyword">\input</span>&#123;colors.tex&#125;</span><br><span class="line"><span class="keyword">\ExplSyntaxOn</span></span><br><span class="line"><span class="keyword">\NewDocumentCommand</span>&#123;<span class="keyword">\helix</span>&#125;&#123; m m m&#125;</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">\draw</span>[line~width=2pt,<span class="params">#2</span>] <span class="params">#1</span>+(0 <span class="keyword">\c_colon_str</span> <span class="params">#3</span>)--+(60 <span class="keyword">\c_colon_str</span> <span class="params">#3</span>)--+(120 <span class="keyword">\c_colon_str</span> <span class="params">#3</span>)--+(180 <span class="keyword">\c_colon_str</span> <span class="params">#3</span>)--+(240 <span class="keyword">\c_colon_str</span> <span class="params">#3</span>)--+(300 <span class="keyword">\c_colon_str</span> <span class="params">#3</span>)--cycle;</span><br><span class="line">    <span class="keyword">\draw</span>[line~width=2pt,<span class="params">#2</span>] <span class="params">#1</span>+(10 <span class="keyword">\c_colon_str</span> <span class="params">#3</span>)--+(70 <span class="keyword">\c_colon_str</span> <span class="params">#3</span>)--+(130 <span class="keyword">\c_colon_str</span> <span class="params">#3</span>)--+(190 <span class="keyword">\c_colon_str</span> <span class="params">#3</span>)--+(250 <span class="keyword">\c_colon_str</span> <span class="params">#3</span>)--+(310 <span class="keyword">\c_colon_str</span> <span class="params">#3</span>)--cycle;</span><br><span class="line">    <span class="keyword">\draw</span>[line~width=2pt,<span class="params">#2</span>] <span class="params">#1</span>+(20 <span class="keyword">\c_colon_str</span> <span class="params">#3</span>)--+(80 <span class="keyword">\c_colon_str</span> <span class="params">#3</span>)--+(140 <span class="keyword">\c_colon_str</span> <span class="params">#3</span>)--+(200 <span class="keyword">\c_colon_str</span> <span class="params">#3</span>)--+(260 <span class="keyword">\c_colon_str</span> <span class="params">#3</span>)--+(320 <span class="keyword">\c_colon_str</span> <span class="params">#3</span>)--cycle;</span><br><span class="line">    <span class="keyword">\draw</span>[line~width=2pt,<span class="params">#2</span>] <span class="params">#1</span>+(30 <span class="keyword">\c_colon_str</span> <span class="params">#3</span>)--+(90 <span class="keyword">\c_colon_str</span> <span class="params">#3</span>)--+(150 <span class="keyword">\c_colon_str</span> <span class="params">#3</span>)--+(210 <span class="keyword">\c_colon_str</span> <span class="params">#3</span>)--+(270 <span class="keyword">\c_colon_str</span> <span class="params">#3</span>)--+(330 <span class="keyword">\c_colon_str</span> <span class="params">#3</span>)--cycle;   </span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">\ExplSyntaxOff</span></span><br><span class="line"><span class="keyword">\begin</span>&#123;document&#125;</span><br><span class="line"><span class="keyword">\ExplSyntaxOn</span></span><br><span class="line"><span class="keyword">\begin</span>&#123;tikzpicture&#125;[x=20cm,y=20cm]</span><br><span class="line">    <span class="keyword">\int_step_variable:nnnNn</span>&#123;0&#125;&#123;10&#125;&#123;360&#125; <span class="keyword">\i</span> </span><br><span class="line">     &#123;   </span><br><span class="line">         <span class="keyword">\helix</span>&#123;(<span class="keyword">\i</span> <span class="keyword">\c_colon_str</span> &#123;1-sin(<span class="keyword">\i</span>)&#125;)&#125;&#123;<span class="keyword">\int_rand:nn</span>&#123;1&#125;&#123;20&#125;&#125;&#123;0.15&#125;        </span><br><span class="line">     &#125; </span><br><span class="line"><span class="keyword">\end</span>&#123;tikzpicture&#125;</span><br><span class="line"><span class="keyword">\ExplSyntaxOff</span></span><br><span class="line"><span class="keyword">\end</span>&#123;document&#125;</span><br></pre></td></tr></table></figure>
<p>得到<br><img src="https://pic4.zhimg.com/80/v2-bc27ca6062fe5896b4a2df6a671916df.jpg" alt="Image"></p>
<hr>
<p>点赞，关注都是我的动力鸭~~~</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://example.com/1970/01/01/LaTeX3-args/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="ljguo">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="LJGUO">
      <meta itemprop="description" content="学习交流">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | LJGUO">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/1970/01/01/LaTeX3-args/" class="post-title-link" itemprop="url">在LaTeX中定义多参数命令</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：1970-01-01 08:00:00" itemprop="dateCreated datePublished" datetime="1970-01-01T08:00:00+08:00">1970-01-01</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2022-11-11 22:38:32" itemprop="dateModified" datetime="2022-11-11T22:38:32+08:00">2022-11-11</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/LaTeX/" itemprop="url" rel="index"><span itemprop="name">LaTeX</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <blockquote>
<p>本文将要利用 <strong>xparse</strong> 宏包和 <strong>LaTeX3</strong> 的 <strong>l3keys</strong> 模块来构建一个简单的多参数命令   </p>
</blockquote>
<h2 id="提出问题"><a href="#提出问题" class="headerlink" title="提出问题"></a>提出问题</h2><p>在 <strong>LaTeX</strong> 中，一个命令最多接受 9 个参数，虽然在日常使用中远远够了，但还是有一些用户有这方面的需求，我们下面来举一个简单的例子</p>
<figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">\newcommand</span>&#123;<span class="keyword">\rectangle</span>&#125;[4]</span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">\begin</span>&#123;tikzpicture&#125;</span><br><span class="line">    <span class="keyword">\draw</span>[line width=<span class="params">#3</span>,draw=<span class="params">#4</span>](0,0) rectangle (<span class="params">#1</span>,<span class="params">#2</span>);</span><br><span class="line">  <span class="keyword">\end</span>&#123;tikzpicture&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>创建了一个画矩形的命令 <code>\rectangle</code> , 它接受 4 个参数分别是 <code>\rectangle&#123;&lt;width&gt;&#125;&#123;&lt;height&gt;&#125;&#123;&lt;line width&gt;&#125;&#123;&lt;color&gt;&#125;</code> 也即是 <strong>宽、高、线宽、颜色</strong> ，这样虽然是合法的，但是难免显得有些臃肿，如果参数再多几个，久而久之，参数顺序估计都忘记了.</p>
<h2 id="讨论问题"><a href="#讨论问题" class="headerlink" title="讨论问题"></a>讨论问题</h2><p>首先，我们应该放弃前面的思维方式，然后使用一种更好的方法来解决它，观察如下代码</p>
<figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">\rectangle</span></span><br><span class="line">&#123;</span><br><span class="line">  width=2cm,</span><br><span class="line">  height=3cm,</span><br><span class="line">  linewidth=1pt,</span><br><span class="line">  color=red,</span><br><span class="line">  ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>这样，这个命令仅接受一个参数，但效果却比上面的好得多，我们不用去记住参数顺序，而且可以为每个参数设置一个默认值，当缺省时，就使用默认值. 以上就是所谓的 <code>key = val </code> 键值对.</p>
<h2 id="解决问题"><a href="#解决问题" class="headerlink" title="解决问题"></a>解决问题</h2><h3 id="xparse-宏包简介"><a href="#xparse-宏包简介" class="headerlink" title="xparse 宏包简介"></a>xparse 宏包简介</h3><p><strong>xparse</strong> 宏包是基于 <strong>LaTeX3</strong> 编写的一个更加强大的创建命令或环境的宏包，它提供了<code>\NewDocumentCommand</code> 用于取代原 <strong>LaTeX2e</strong> 中的 <code>\newcommand</code> ,例如</p>
<figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">\NewDocumentCommand</span>&#123;<span class="keyword">\foo</span>&#125;&#123;m&#125;&#123;my name is <span class="params">#1</span>.&#125;</span><br><span class="line"><span class="keyword">\foo</span>&#123;ljguo&#125;</span><br></pre></td></tr></table></figure>

<h4 id="部分参数介绍"><a href="#部分参数介绍" class="headerlink" title="部分参数介绍"></a>部分参数介绍</h4><ul>
<li><p><strong>m</strong> : 标准必选参数</p>
</li>
<li><p><strong>o</strong>  : 标准可选参数 , 如果缺省，会返回一个 <code>-NoValue-</code> 标记</p>
</li>
<li><p><strong>O</strong>{default} : 同 <strong>o</strong> ,但可以带一个默认值</p>
</li>
<li><p><strong>s</strong> :  带星号命令 </p>
</li>
<li><p><strong>v</strong> : 抄录参数</p>
</li>
</ul>
<h4 id="几个命令介绍"><a href="#几个命令介绍" class="headerlink" title="几个命令介绍"></a>几个命令介绍</h4><ul>
<li><p><code>\IfNoValueTF</code> , <code>\IfNoValueT</code> , <code>\IfNoValueF</code> 用于判断所接受参数是否为  <code>-NoValue-</code> 标记</p>
</li>
<li><p><code>\IfBooleanTF</code> , <code>\IfBooleanT</code> , <code>\IfBooleanF</code> 用于判断所接受参数的逻辑值，主要用于 <strong>s</strong> 类参数</p>
</li>
</ul>
<h4 id="使用样例"><a href="#使用样例" class="headerlink" title="使用样例"></a>使用样例</h4><blockquote>
<figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">\NewDocumentCommand</span>&#123;<span class="keyword">\foo</span>&#125;&#123;m&#125;&#123;my name is <span class="params">#1</span>.&#125;</span><br><span class="line"><span class="keyword">\foo</span>&#123;ljguo&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">my name is ljguo.</span><br></pre></td></tr></table></figure>
</blockquote>
<blockquote>
<figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">\NewDocumentCommand</span>&#123;<span class="keyword">\foo</span>&#125;&#123;o&#125;&#123;my name is <span class="params">#1</span>.&#125;</span><br><span class="line"><span class="keyword">\foo</span></span><br><span class="line"><span class="keyword">\foo</span>[ljguo]</span><br></pre></td></tr></table></figure>

<figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">my name is -NoValue-.</span><br><span class="line">my name is ljguo.</span><br></pre></td></tr></table></figure>
</blockquote>
<blockquote>
<figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">\NewDocumentCommand</span>&#123;<span class="keyword">\foo</span>&#125;&#123;O&#123;ljguo&#125;&#125;&#123;my name is <span class="params">#1</span>.&#125;</span><br><span class="line"><span class="keyword">\foo</span></span><br><span class="line"><span class="keyword">\foo</span>[latexer]</span><br></pre></td></tr></table></figure>

<figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">my name is ljguo.</span><br><span class="line">my name is latexer.</span><br></pre></td></tr></table></figure>
</blockquote>
<blockquote>
<figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">\NewDocumentCommand</span>&#123;<span class="keyword">\foo</span>&#125;&#123;s&#125;</span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">\IfBooleanTF</span>&#123;<span class="params">#1</span>&#125;</span><br><span class="line">  &#123;i have star.&#125;</span><br><span class="line">  &#123;i dont have star.&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">\foo</span></span><br><span class="line"><span class="keyword">\foo</span>*</span><br></pre></td></tr></table></figure>

<figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">i dont have star.</span><br><span class="line">i have star.</span><br></pre></td></tr></table></figure>
</blockquote>
<h3 id="l3keys-模块简介"><a href="#l3keys-模块简介" class="headerlink" title="l3keys 模块简介"></a>l3keys 模块简介</h3><p>主要用到两个函数</p>
<ul>
<li><code>\keys_define:nn</code> : 用于设置键值对</li>
<li><code>\keys_set:nn</code> : 用于为键值对赋值</li>
<li>这两个函数的第一个参数接受模块名</li>
</ul>
<p>注意：使用 <strong>LaTeX3</strong> 语法应当将该部分代码放在 <code>\ExplSyntaxOn</code> 和 <code>\ExplSyntaxOff</code> 之间</p>
<blockquote>
<figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">\ExplSyntaxOn</span> </span><br><span class="line"><span class="keyword">\keys_define:nn</span>&#123;example&#125; <span class="comment">%为 example 模块设置键值对</span></span><br><span class="line">&#123;</span><br><span class="line">  name.tl<span class="built_in">_</span>set:N  = <span class="keyword">\l_name_tl</span>,    <span class="comment">%将 name 保存到一个 tl 变量中</span></span><br><span class="line">  name.default:n = ljguo,         <span class="comment">%为 name 设置默认值</span></span><br><span class="line">  name.initial:n = ljguo,         <span class="comment">%为 name 设置初始值</span></span><br><span class="line">  age.int<span class="built_in">_</span>set:N  = <span class="keyword">\l_age_int</span>,    <span class="comment">%将 age 保存到一个 int 变量中</span></span><br><span class="line">  age.default:n  = 21,            <span class="comment">%为 age 设置默认值</span></span><br><span class="line">  age.initial:n  = 21             <span class="comment">%为 age 设置初始值</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">\NewDocumentCommand</span>&#123;<span class="keyword">\showinfo</span>&#125;&#123;&#125; <span class="comment">% 构建一个命令，用于输出个人信息</span></span><br><span class="line">&#123;</span><br><span class="line">  hello,~my~name~is~<span class="keyword">\tl_use:c</span> &#123;l<span class="built_in">_</span>name<span class="built_in">_</span>tl&#125;,~and~i~am~<span class="keyword">\int_use:c</span> &#123;l<span class="built_in">_</span>age<span class="built_in">_</span>int&#125; ~ years~old.  </span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">\showinfo</span></span><br><span class="line"><span class="keyword">\keys_set:nn</span>&#123;example&#125; <span class="comment">%为 example 模块的键值赋值</span></span><br><span class="line">&#123;</span><br><span class="line">  name = latexer,</span><br><span class="line">  age  = 50</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">\showinfo</span></span><br><span class="line"><span class="keyword">\ExplSyntaxOff</span></span><br></pre></td></tr></table></figure>

<figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">hello, my name is ljguo, and i am 21 years old.</span><br><span class="line">hello, my name is latexer, and i am 50 years old.</span><br></pre></td></tr></table></figure>
</blockquote>
<h2 id="回到原问题"><a href="#回到原问题" class="headerlink" title="回到原问题"></a>回到原问题</h2><p>现在我们再来定义一个<code>\rectangle</code> 命令</p>
<p>首先设置键值对，需要四个键值</p>
<blockquote>
<figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">\ExplSyntaxOn</span></span><br><span class="line"><span class="keyword">\keys_define:nn</span>&#123;rectangle&#125;</span><br><span class="line">&#123;</span><br><span class="line">  width.dim<span class="built_in">_</span>set:N        = <span class="keyword">\l_width_dim</span>,</span><br><span class="line">  width.default:n        = 2cm,</span><br><span class="line">  width.initial:n        = 2cm,</span><br><span class="line">  height.dim<span class="built_in">_</span>set:N       = <span class="keyword">\l_height_dim</span>,</span><br><span class="line">  height.default:n       = 3cm,</span><br><span class="line">  height.initial:n       = 3cm,</span><br><span class="line">  linewidth.dim<span class="built_in">_</span>set:N    = <span class="keyword">\l_linewidth_dim</span>,</span><br><span class="line">  linewidth.default:n    = 1pt,</span><br><span class="line">  linewidth.initial:n    = 1pt,</span><br><span class="line">  color.tl<span class="built_in">_</span>set:N         = <span class="keyword">\l_color_tl</span>,</span><br><span class="line">  color.default:n        = cyan,</span><br><span class="line">  color.initial:n        =cyan</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">\NewDocumentCommand</span>&#123;<span class="keyword">\rectangle</span>&#125;&#123;O&#123;&#125;&#125;</span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">\group_begin:</span> </span><br><span class="line">  <span class="keyword">\keys_set:nn</span>&#123;rectangle&#125;&#123;<span class="params">#1</span>&#125;</span><br><span class="line">  <span class="keyword">\begin</span>&#123;tikzpicture&#125;</span><br><span class="line">    <span class="keyword">\draw</span>[line~width = <span class="keyword">\dim_use:N</span> <span class="keyword">\l_linewidth_dim</span>,draw = <span class="keyword">\tl_use:N</span>     <span class="keyword">\l_color_tl</span>](0,0)rectangle(<span class="keyword">\dim_use:N</span> <span class="keyword">\l_width_dim</span>,<span class="keyword">\dim_use:N</span> <span class="keyword">\l_height_dim</span>);</span><br><span class="line">  <span class="keyword">\end</span>&#123;tikzpicture&#125;</span><br><span class="line">  <span class="keyword">\group_end:</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">\rectangle</span><span class="keyword">\par</span></span><br><span class="line"><span class="keyword">\rectangle</span></span><br><span class="line">[</span><br><span class="line">  width = 3cm,</span><br><span class="line">  height = 2cm,</span><br><span class="line">  color = red</span><br><span class="line">]</span><br><span class="line"><span class="keyword">\ExplSyntaxOff</span></span><br></pre></td></tr></table></figure>

</blockquote>
<h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><p><strong>xparse</strong> 宏包是一个非常优秀的宏包，值得大家去学习，另外，作者水平有限，如有错误或者疑问，欢迎联系我</p>
<ul>
<li><strong>QQ</strong> : 1123203930</li>
<li><strong>Email</strong> : <a href="mailto:&#49;&#49;&#50;&#x33;&#50;&#x30;&#x33;&#x39;&#51;&#x30;&#64;&#113;&#x71;&#46;&#x63;&#x6f;&#x6d;">&#49;&#49;&#50;&#x33;&#50;&#x30;&#x33;&#x39;&#51;&#x30;&#64;&#113;&#x71;&#46;&#x63;&#x6f;&#x6d;</a></li>
</ul>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://example.com/1970/01/01/LaTeX3-digui/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="ljguo">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="LJGUO">
      <meta itemprop="description" content="学习交流">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | LJGUO">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/1970/01/01/LaTeX3-digui/" class="post-title-link" itemprop="url">LaTeX3实例--函数递归</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：1970-01-01 08:00:00" itemprop="dateCreated datePublished" datetime="1970-01-01T08:00:00+08:00">1970-01-01</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2022-11-11 22:43:21" itemprop="dateModified" datetime="2022-11-11T22:43:21+08:00">2022-11-11</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/LaTeX/" itemprop="url" rel="index"><span itemprop="name">LaTeX</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>使用LaTeX3实现简单的函数递归，并计算正整数的阶乘和斐波那契数列   </p>
<p>核心代码</p>
<figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">\cs_set:Npn</span> <span class="keyword">\froac</span>:n <span class="params">#1</span>&#123;</span><br><span class="line"><span class="keyword">\int_compare:nNnTF</span>&#123;<span class="params">#1</span>&#125;=&#123;0&#125;&#123;1&#125;</span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">\fp_eval:n</span>&#123;(<span class="params">#1</span>)*<span class="keyword">\froac</span>:n&#123;<span class="params">#1</span>-1&#125;&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">\cs_set:Npn</span> <span class="keyword">\fibon</span>:n <span class="params">#1</span>&#123;</span><br><span class="line"><span class="keyword">\int_compare:nNnTF</span>&#123;<span class="params">#1</span>&#125;=&#123;0&#125;&#123;0&#125;</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">\int_compare:nNnTF</span>&#123;<span class="params">#1</span>&#125;=&#123;1&#125;&#123;1&#125;</span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">\fp_eval:n</span>&#123;<span class="keyword">\fibon</span>:n&#123;<span class="params">#1</span>-1&#125;+<span class="keyword">\fibon</span>:n&#123;<span class="params">#1</span>-2&#125;&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>输出接口</p>
<figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">\NewDocumentCommand</span>&#123;<span class="keyword">\fact</span>&#125;&#123;m&#125;&#123;</span><br><span class="line"><span class="params">#1</span>!~=~<span class="keyword">\froac</span>:n&#123;<span class="params">#1</span>&#125;<span class="keyword">\par</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">\NewDocumentCommand</span>&#123;<span class="keyword">\fibon</span>&#125;&#123;m&#125;&#123;</span><br><span class="line">F(<span class="params">#1</span>)~=~<span class="keyword">\fibon</span>:n&#123;<span class="params">#1</span>&#125;<span class="keyword">\par</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>完整代码</p>
<figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">\documentclass</span>&#123;ctexart&#125;</span><br><span class="line"><span class="keyword">\usepackage</span>&#123;mathtools,amsmath&#125;</span><br><span class="line"><span class="keyword">\usepackage</span>[paperwidth=18cm,margin=3cm]&#123;geometry&#125;</span><br><span class="line"><span class="keyword">\ExplSyntaxOn</span></span><br><span class="line"><span class="keyword">\cs_set:Npn</span> <span class="keyword">\froac</span>:n <span class="params">#1</span>&#123;</span><br><span class="line"><span class="keyword">\int_compare:nNnTF</span>&#123;<span class="params">#1</span>&#125;=&#123;0&#125;&#123;1&#125;</span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">\fp_eval:n</span>&#123;(<span class="params">#1</span>)*<span class="keyword">\froac</span>:n&#123;<span class="params">#1</span>-1&#125;&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">\cs_set:Npn</span> <span class="keyword">\fibon</span>:n <span class="params">#1</span>&#123;</span><br><span class="line"><span class="keyword">\int_compare:nNnTF</span>&#123;<span class="params">#1</span>&#125;=&#123;0&#125;&#123;0&#125;</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">\int_compare:nNnTF</span>&#123;<span class="params">#1</span>&#125;=&#123;1&#125;&#123;1&#125;</span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">\fp_eval:n</span>&#123;<span class="keyword">\fibon</span>:n&#123;<span class="params">#1</span>-1&#125;+<span class="keyword">\fibon</span>:n&#123;<span class="params">#1</span>-2&#125;&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">\NewDocumentCommand</span>&#123;<span class="keyword">\fact</span>&#125;&#123;m&#125;&#123;</span><br><span class="line"><span class="params">#1</span>!~=~<span class="keyword">\froac</span>:n&#123;<span class="params">#1</span>&#125;<span class="keyword">\par</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">\NewDocumentCommand</span>&#123;<span class="keyword">\fibon</span>&#125;&#123;m&#125;&#123;</span><br><span class="line">F(<span class="params">#1</span>)~=~<span class="keyword">\fibon</span>:n&#123;<span class="params">#1</span>&#125;<span class="keyword">\par</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">\ExplSyntaxOff</span></span><br><span class="line"><span class="keyword">\begin</span>&#123;document&#125;</span><br><span class="line"><span class="keyword">\title</span>&#123;<span class="keyword">\LaTeX</span>3---使用递归&#125;</span><br><span class="line"><span class="keyword">\author</span>&#123;ljguo1020@gmail.com&#125;</span><br><span class="line"><span class="keyword">\maketitle</span></span><br><span class="line"><span class="keyword">\ExplSyntaxOn</span></span><br><span class="line">计算~<span class="built_in">$</span>n!<span class="built_in">$</span>~</span><br><span class="line"><span class="keyword">\[</span></span><br><span class="line">  n!= </span><br><span class="line">    <span class="keyword">\begin</span>&#123;dcases&#125;</span><br><span class="line">        1,<span class="built_in">&amp;</span>n=0<span class="keyword">\\</span></span><br><span class="line">        n(n-1)!,<span class="built_in">&amp;</span>n<span class="keyword">\geq</span> ~ 1</span><br><span class="line">    <span class="keyword">\end</span>&#123;dcases&#125;</span><br><span class="line"><span class="keyword">\]</span><span class="keyword">\par</span></span><br><span class="line"><span class="keyword">\int_step_function:nN</span>&#123;20&#125;<span class="keyword">\fact</span></span><br><span class="line"><span class="keyword">\newpage</span></span><br><span class="line">计算斐波那契数列</span><br><span class="line"><span class="keyword">\[</span></span><br><span class="line">F(n)=</span><br><span class="line"><span class="keyword">\begin</span>&#123;dcases&#125;</span><br><span class="line">    0,<span class="built_in">&amp;</span>n=0<span class="keyword">\\</span></span><br><span class="line">    1,<span class="built_in">&amp;</span>n=1<span class="keyword">\\</span></span><br><span class="line">    F(n-1)+F(n-2),<span class="built_in">&amp;</span>n<span class="keyword">\geq</span> 2</span><br><span class="line"><span class="keyword">\end</span>&#123;dcases&#125;</span><br><span class="line"><span class="keyword">\]</span><span class="keyword">\par</span></span><br><span class="line"><span class="keyword">\int_step_function:nN</span>&#123;20&#125;<span class="keyword">\fibon</span></span><br><span class="line"><span class="keyword">\ExplSyntaxOff</span></span><br><span class="line"><span class="keyword">\end</span>&#123;document&#125;</span><br></pre></td></tr></table></figure>
<p>输出<br><img src="https://pic4.zhimg.com/80/v2-19c642f79782c8692c2672ea292ae4ae.png" alt="Image"><br><img src="https://pic4.zhimg.com/80/v2-f11eb0d1d7f506ec54ef4c34cb05389c.png" alt="Image"></p>
<hr>
<p>关注，点赞都是我的动力鸭~~~</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://example.com/1970/01/01/LaTeX3-intarry/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="ljguo">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="LJGUO">
      <meta itemprop="description" content="学习交流">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | LJGUO">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/1970/01/01/LaTeX3-intarry/" class="post-title-link" itemprop="url">LaTeX3--整数数组</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：1970-01-01 08:00:00" itemprop="dateCreated datePublished" datetime="1970-01-01T08:00:00+08:00">1970-01-01</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2022-11-11 22:39:27" itemprop="dateModified" datetime="2022-11-11T22:39:27+08:00">2022-11-11</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/LaTeX/" itemprop="url" rel="index"><span itemprop="name">LaTeX</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>本文仅介绍 LaTeX3 整数数组模块</p>
<hr>
<p>区别于其它语言的一点：数组首个元素编号是 1， 而不是 0.</p>
<h2 id="构建数组"><a href="#构建数组" class="headerlink" title="构建数组"></a>构建数组</h2><p>构建一个长度为 5 的数组 <code>\l_array_int</code></p>
<figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">\intarray_new:Nn</span> <span class="keyword">\l_array_int</span> &#123;5&#125;</span><br></pre></td></tr></table></figure>
<h2 id="数组赋值"><a href="#数组赋值" class="headerlink" title="数组赋值"></a>数组赋值</h2><p>给数组第 3 个元素赋值为 5.</p>
<figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">\intarray_gset:Nnn</span> <span class="keyword">\l_array_int</span> &#123;3&#125;&#123;5&#125;</span><br></pre></td></tr></table></figure>
<h2 id="整体赋值"><a href="#整体赋值" class="headerlink" title="整体赋值"></a>整体赋值</h2><p>可以不用提前声明数组长度</p>
<figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">\intarray_const_from_clist:Nn</span> <span class="keyword">\l_array_int</span> &#123;2,5,4,1,6&#125;</span><br></pre></td></tr></table></figure>
<h2 id="获取数组长度"><a href="#获取数组长度" class="headerlink" title="获取数组长度"></a>获取数组长度</h2><figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">\intarray_const_from_clist:Nn</span> <span class="keyword">\l_array_int</span> &#123;2,5,4,1,6,10,5&#125;</span><br><span class="line"><span class="keyword">\intarray_count:N</span> <span class="keyword">\l_array_int</span> <span class="comment">%---&gt; 7</span></span><br></pre></td></tr></table></figure>
<h2 id="使用数组"><a href="#使用数组" class="headerlink" title="使用数组"></a>使用数组</h2><figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">\intarray_item:Nn</span> <span class="keyword">\l_array_int</span> &#123;3&#125; <span class="comment">%---&gt; 4</span></span><br></pre></td></tr></table></figure>
<figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">\intarray_rand_item:N</span> <span class="keyword">\l_array_int</span> <span class="comment">%随机输出一个元素</span></span><br></pre></td></tr></table></figure>
<h2 id="初始化数组"><a href="#初始化数组" class="headerlink" title="初始化数组"></a>初始化数组</h2><figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">\intarray_gzero:N</span> <span class="keyword">\l_array_int</span></span><br></pre></td></tr></table></figure>
<h2 id="其它"><a href="#其它" class="headerlink" title="其它"></a>其它</h2><figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">\intarray_show:N</span> ...</span><br><span class="line"><span class="keyword">\intarray_log:N</span> ...</span><br></pre></td></tr></table></figure>

<hr>
<p>点赞，收藏都是我的动力鸭~~~</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://example.com/1970/01/01/LaTeX3-prop/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="ljguo">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="LJGUO">
      <meta itemprop="description" content="学习交流">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | LJGUO">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/1970/01/01/LaTeX3-prop/" class="post-title-link" itemprop="url">LaTeX3---prop (属性列表)</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：1970-01-01 08:00:00" itemprop="dateCreated datePublished" datetime="1970-01-01T08:00:00+08:00">1970-01-01</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2022-11-11 22:39:35" itemprop="dateModified" datetime="2022-11-11T22:39:35+08:00">2022-11-11</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/LaTeX/" itemprop="url" rel="index"><span itemprop="name">LaTeX</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <blockquote>
<p>本文介绍LaTeX3的 prop 模块<br>简介：主要用来设置一些键值(keyval)，但是与l3keys模块又有区别</p>
</blockquote>
<h2 id="创建和初始化属性列表"><a href="#创建和初始化属性列表" class="headerlink" title="创建和初始化属性列表"></a>创建和初始化属性列表</h2><h3 id="新建一个属性列表"><a href="#新建一个属性列表" class="headerlink" title="新建一个属性列表"></a>新建一个属性列表</h3><figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">\prop_new:N</span> <span class="keyword">\l_my_prop</span></span><br><span class="line"><span class="keyword">\prop_new:c</span> &#123;l<span class="built_in">_</span>my<span class="built_in">_</span>prop&#125;</span><br></pre></td></tr></table></figure>

<h3 id="初始化-清空内容"><a href="#初始化-清空内容" class="headerlink" title="初始化(清空内容)"></a>初始化(清空内容)</h3><figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">\prop_clear:N</span> <span class="keyword">\l_my_prop</span></span><br><span class="line"><span class="keyword">\prop_clear:c</span> ...</span><br><span class="line"><span class="keyword">\prop_gclear:N</span> ...</span><br><span class="line"><span class="keyword">\prop_gclear:c</span> ...</span><br></pre></td></tr></table></figure>

<p>检测是否存在，如果存在就清空.如果不存在就创建，然后清空</p>
<figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">\prop_clear_new:N</span> <span class="keyword">\l_my_prop</span></span><br><span class="line"><span class="keyword">\prop_clear_new:c</span> </span><br><span class="line"><span class="keyword">\prop_gclear_new:N</span></span><br><span class="line"><span class="keyword">\prop_gclear_new:c</span></span><br></pre></td></tr></table></figure>

<h2 id="赋值"><a href="#赋值" class="headerlink" title="赋值"></a>赋值</h2><h3 id="直接赋值"><a href="#直接赋值" class="headerlink" title="直接赋值"></a>直接赋值</h3><figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">\prop_set_from_keyval:Nn</span> <span class="keyword">\l_my_prop</span></span><br><span class="line">&#123;</span><br><span class="line">	key1 = val1,</span><br><span class="line">	key2 = val2,</span><br><span class="line">	key3 = val3,</span><br><span class="line">	...</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">\prop_set_from_keyval:cn</span></span><br><span class="line"><span class="keyword">\prop_gset_from_keyval:Nn</span></span><br><span class="line"><span class="keyword">\prop_gset_from_keyval:cn</span></span><br></pre></td></tr></table></figure>

<h3 id="创建副本"><a href="#创建副本" class="headerlink" title="创建副本"></a>创建副本</h3><p>这让 <code>\l_myb_prop</code> 和<code>\l_mya_prop</code> 相等</p>
<figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">\prop_set_eq:NN</span> <span class="keyword">\l_mab_prop</span> <span class="keyword">\l_mya_prop</span></span><br></pre></td></tr></table></figure>

<h3 id="常量"><a href="#常量" class="headerlink" title="常量"></a>常量</h3><figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">\prop_const_from_keyval:Nn</span><span class="keyword">\l_my_prop</span></span><br><span class="line">&#123;</span><br><span class="line">	key1 = val1,</span><br><span class="line">	key2 = val2,</span><br><span class="line">	key3 = val3,</span><br><span class="line">	...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="追加-put"><a href="#追加-put" class="headerlink" title="追加(put)"></a>追加(put)</h3><p>直接追加</p>
<figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">\prop_put:Nnn</span> <span class="keyword">\l_my_prop</span> &#123;key4&#125;&#123;val4&#125;</span><br></pre></td></tr></table></figure>

<p>先检测键值是否存在，如果存在，则什么也不做，不存在就为其追加. 区别于前者的是，如果存在，前者会覆盖掉</p>
<figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">\prop_put_if_new:Nnn</span> <span class="keyword">\l_my_prop</span> &#123;key4&#125;&#123;val4&#125;</span><br></pre></td></tr></table></figure>

<h3 id="结合"><a href="#结合" class="headerlink" title="结合"></a>结合</h3><p>将后面两个属性列表组合起来，给第一个列表</p>
<figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">\prop_concat:NNN</span> <span class="keyword">\l_mya_prop</span> <span class="keyword">\l_myb_prop</span> <span class="keyword">\l_myc_prop</span></span><br></pre></td></tr></table></figure>

<h3 id="以键值形式追加"><a href="#以键值形式追加" class="headerlink" title="以键值形式追加"></a>以键值形式追加</h3><figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">\prop_put_from_keyval:Nn</span> <span class="keyword">\l_my_prop</span></span><br><span class="line">&#123;</span><br><span class="line">⟨key1⟩ = ⟨value1⟩ ,</span><br><span class="line">⟨key2⟩ = ⟨value2⟩ ,</span><br><span class="line">...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="使用"><a href="#使用" class="headerlink" title="使用"></a>使用</h2><h3 id="传递给一个变量"><a href="#传递给一个变量" class="headerlink" title="传递给一个变量"></a>传递给一个变量</h3><figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">\prop_get:NnN</span> <span class="keyword">\l_my_prop</span> &#123;key1&#125; <span class="keyword">\l_my_tl</span></span><br></pre></td></tr></table></figure>

<p>此时，<code>\l_my_tl</code>中保存的值就是<code>val1</code> </p>
<h3 id="直接使用"><a href="#直接使用" class="headerlink" title="直接使用"></a>直接使用</h3><figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">\prop_item:Nn</span> <span class="keyword">\l_my_prop</span> &#123;key1&#125; <span class="comment">% ---&gt; val1</span></span><br></pre></td></tr></table></figure>

<h2 id="计算属性列表数量"><a href="#计算属性列表数量" class="headerlink" title="计算属性列表数量"></a>计算属性列表数量</h2><figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">\prop_count:N</span> <span class="keyword">\l_my_prop</span> <span class="comment">% 返回一个整数</span></span><br></pre></td></tr></table></figure>

<h2 id="移除"><a href="#移除" class="headerlink" title="移除"></a>移除</h2><figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">\prop_remove:Nn</span> <span class="keyword">\l_my_prop</span> &#123;key2&#125;</span><br></pre></td></tr></table></figure>

<h2 id="条件判断"><a href="#条件判断" class="headerlink" title="条件判断"></a>条件判断</h2><h3 id="检测是否存在"><a href="#检测是否存在" class="headerlink" title="检测是否存在"></a>检测是否存在</h3><figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">\prop_if_exist_p:N</span> <span class="keyword">\l_my_prop</span></span><br><span class="line"><span class="keyword">\prop_if_exist:NTF</span> <span class="keyword">\l_my_prop</span> &#123;true code&#125;&#123;false code&#125;</span><br></pre></td></tr></table></figure>

<h3 id="检测是否为空"><a href="#检测是否为空" class="headerlink" title="检测是否为空"></a>检测是否为空</h3><figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">\prop_if_empty_p:N</span> <span class="keyword">\l_my_prop</span></span><br><span class="line"><span class="keyword">\prop_if_empty:NTF</span> <span class="keyword">\l_my_prop</span> &#123;true code&#125;&#123;false code&#125;</span><br></pre></td></tr></table></figure>

<h3 id="检测某键值是否存在"><a href="#检测某键值是否存在" class="headerlink" title="检测某键值是否存在"></a>检测某键值是否存在</h3><figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">\prop_if_in:NnTF</span> <span class="keyword">\l_my_prop</span>&#123;key4&#125;&#123;true code&#125;&#123;false code&#125;</span><br></pre></td></tr></table></figure>

<h2 id="循环"><a href="#循环" class="headerlink" title="循环"></a>循环</h2><h3 id="遍历"><a href="#遍历" class="headerlink" title="遍历"></a>遍历</h3><p>将<code>keys</code>和<code>vals</code>通过参数传递给函数,所以函数应当接受两个参数</p>
<figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">\prop_map_function:NN</span> <span class="keyword">\l_my_prop</span> <span class="keyword">\my_cmd:nn</span></span><br></pre></td></tr></table></figure>

<p>example</p>
<figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">\cs_new:Nn</span> <span class="keyword">\my_cmd:nn</span> &#123;<span class="params">#1</span>~:~i~love~<span class="params">#2</span>.<span class="keyword">\par</span>&#125;</span><br><span class="line"><span class="keyword">\prop_new:N</span> <span class="keyword">\l_my_prop</span></span><br><span class="line"><span class="keyword">\prop_set_from_keyval:Nn</span> <span class="keyword">\l_my_prop</span></span><br><span class="line">&#123;</span><br><span class="line">   a = 杨幂,</span><br><span class="line">   b = 迪丽热巴,</span><br><span class="line">   c = 周冬雨</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">\prop_map_function:NN</span> <span class="keyword">\l_my_prop</span> <span class="keyword">\my_cmd:nn</span></span><br></pre></td></tr></table></figure>

<p>这会得到</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">a : i love 杨幂.</span><br><span class="line">b : i love 迪丽热巴.</span><br><span class="line">c : i love 周冬雨.</span><br></pre></td></tr></table></figure>

<figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">\prop_map_inline:Nn</span> <span class="keyword">\l_my_prop</span> &#123;code&#125;</span><br></pre></td></tr></table></figure>

<p><code>code</code>中可以带两个参数，用于代表<code>key</code>和<code>val</code></p>
<p>example</p>
<figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">\prop_new:N</span> <span class="keyword">\l_my_prop</span></span><br><span class="line"><span class="keyword">\prop_set_from_keyval:Nn</span> <span class="keyword">\l_my_prop</span></span><br><span class="line">&#123;</span><br><span class="line">   a = 杨幂,</span><br><span class="line">   b = 迪丽热巴,</span><br><span class="line">   c = 周冬雨</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">\prop_map_inline:Nn</span> <span class="keyword">\l_my_prop</span>&#123;<span class="params">#1</span>~:~i~love~<span class="params">#2</span>.<span class="keyword">\par</span>&#125; </span><br></pre></td></tr></table></figure>

<p>同样也得到上面的结果</p>
<h3 id="break"><a href="#break" class="headerlink" title="break"></a>break</h3><p>用于终止循环</p>
<figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">\prop_map_break:</span></span><br></pre></td></tr></table></figure>

<p>下面这个函数会在终止循环后再执行一些东西</p>
<figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">\prop_map_break:n</span> &#123;code&#125;</span><br></pre></td></tr></table></figure>

<p>example</p>
<figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">\prop_new:N</span> <span class="keyword">\l_my_prop</span></span><br><span class="line"><span class="keyword">\prop_set_from_keyval:Nn</span> <span class="keyword">\l_my_prop</span></span><br><span class="line">&#123;</span><br><span class="line">   a = 杨幂,</span><br><span class="line">   b = 迪丽热巴,</span><br><span class="line">   c = 周冬雨</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">\prop_map_inline:Nn</span> <span class="keyword">\l_my_prop</span></span><br><span class="line">&#123;</span><br><span class="line"> 	<span class="keyword">\str_if_eq:nnTF</span>&#123;<span class="params">#1</span>&#125;&#123;c&#125;</span><br><span class="line"> 	&#123;</span><br><span class="line"> 		<span class="keyword">\prop_map_break:</span></span><br><span class="line"> 	&#125;</span><br><span class="line"> 	&#123;</span><br><span class="line"> 		<span class="params">#1</span>~:~i~love~<span class="params">#2</span>.<span class="keyword">\par</span></span><br><span class="line"> 	&#125;</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure>

<p>这将只得到</p>
<figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">a : i love 杨幂.</span><br><span class="line">b : i love 迪丽热巴.</span><br></pre></td></tr></table></figure>

<hr>
<p>该模块暂时更新到这里吧</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




  <nav class="pagination">
    <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><a class="page-number" href="/page/3/">3</a><a class="extend next" rel="next" href="/page/2/"><i class="fa fa-angle-right" aria-label="下一页"></i></a>
  </nav>

</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">


<div class="copyright">
  &copy; 
  <span itemprop="copyrightYear">2022</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">ljguo</span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io/" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/" rel="noopener" target="_blank">NexT.Gemini</a> 强力驱动
  </div>

    </div>
  </footer>

  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.1/jquery.min.js" integrity="sha256-o88AwQnZB+VDvE9tvIXrMQaPlFFSUTR+nldQm1LuPXQ=" crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.js" integrity="sha256-yt2kYMy0w8AbtF89WXb2P1rfjcP/HTHLT7097U8Y5b8=" crossorigin="anonymous"></script>
<script src="/js/comments.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/next-boot.js"></script>

  



  <script src="/js/third-party/fancybox.js"></script>


  




  

  <script class="next-config" data-name="enableMath" type="application/json">true</script><script class="next-config" data-name="mathjax" type="application/json">{"enable":true,"tags":"all","js":{"url":"https://cdnjs.cloudflare.com/ajax/libs/mathjax/3.2.2/es5/tex-mml-chtml.js","integrity":"sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI="}}</script>
<script src="/js/third-party/math/mathjax.js"></script>



</body>
</html>
